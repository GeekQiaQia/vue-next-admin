var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,d=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,r=(e,a)=>{for(var t in a||(a={}))o.call(a,t)&&d(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&d(e,t,a[t]);return e},n=(e,l)=>a(e,t(l));import{_ as i}from"./lodash.a533b6d4.js";import{r as u}from"./index.5e59d058.js";import{r as c,a7 as p,aJ as m,aB as f,Z as v,a5 as b,b4 as _,X as k,D as j,a4 as y,_ as w,k as g,v as x,a$ as T,c as V,M as I,aH as h,A as P,x as M,aE as S,aC as C}from"./@vue.9dcf4325.js";import"./element-plus.c35c14b5.js";import"./resize-observer-polyfill.af5c5caa.js";import"./@popperjs.b42a2641.js";import"./dayjs.80b0a338.js";import"./mitt.06a3009f.js";import"./async-validator.9224cb80.js";import"./normalize-wheel.1d574cd1.js";import"./vue.1f809ab3.js";import"./vuex.110f31c1.js";import"./js-cookie.aa728e12.js";import"./vue-router.5a690d96.js";import"./css-color-function.a5ba1304.js";import"./color.ccf836c3.js";import"./clone.05e42b91.js";import"./color-convert.755d189f.js";import"./color-name.e7a4e1d3.js";import"./color-string.e356f5de.js";import"./ms.ba588bd8.js";import"./path-to-regexp.2b09bab4.js";import"./fuse.js.c1e3c562.js";import"./path.8db65c51.js";import"./util.3d699e40.js";import"./axios.a57df465.js";import"./mockjs.26632a98.js";const L={class:"task-table"},U={key:1},O={key:1},N={key:1},E=y("保存"),z=y("编辑"),$=y("删除"),D={class:"task-table__add"},A=y("+ 新增任务");var B=p({props:{data:null,status:null},emits:["updateTask","modifyTaskEdit","addProjectTask","deleteProjectTask"],setup(e,{emit:a}){function t(){a("addProjectTask")}return(l,o)=>{const s=m("el-input"),d=m("el-table-column"),i=m("el-option"),u=m("el-select"),c=m("el-tag"),p=m("el-button"),g=m("el-popconfirm"),x=m("el-table");return f(),v("div",L,[b(x,{data:e.data,style:{width:"100%"}},{default:_((()=>[b(d,{prop:"taskName",label:"任务名称"},{default:_((e=>[e.row.edit?(f(),k(s,{key:0,modelValue:e.row.taskName,"onUpdate:modelValue":a=>e.row.taskName=a},null,8,["modelValue","onUpdate:modelValue"])):(f(),v("span",U,j(e.row.taskName),1))])),_:1}),b(d,{prop:"developTime",label:"开发工时"},{default:_((e=>[e.row.edit?(f(),k(s,{key:0,modelValue:e.row.developTime,"onUpdate:modelValue":a=>e.row.developTime=a},null,8,["modelValue","onUpdate:modelValue"])):(f(),v("span",O,j(e.row.developTime),1))])),_:1}),b(d,{prop:"developMember",label:"开发人"},{default:_((e=>[e.row.edit?(f(),k(s,{key:0,modelValue:e.row.developMember,"onUpdate:modelValue":a=>e.row.developMember=a},null,8,["modelValue","onUpdate:modelValue"])):(f(),v("span",N,j(e.row.developMember),1))])),_:1}),b(d,{prop:"taskStatus",label:"任务状态"},{default:_((a=>{var t;return[a.row.edit?(f(),k(u,{key:0,modelValue:a.row.taskStatus,"onUpdate:modelValue":e=>a.row.taskStatus=e,placeholder:"选择任务状态"},{default:_((()=>[b(i,{label:"准备阶段",value:1}),b(i,{label:"开发中",value:2}),b(i,{label:"开发完成",value:3}),b(i,{label:"测试阶段",value:4}),b(i,{label:"待发布",value:5})])),_:2},1032,["modelValue","onUpdate:modelValue"])):(f(),k(c,{key:1,type:null==(t=e.status.get(`${a.row.taskStatus}`))?void 0:t.type},{default:_((()=>{var t;return[y(j(null==(t=e.status.get(`${a.row.taskStatus}`))?void 0:t.text),1)]})),_:2},1032,["type"]))]})),_:1}),b(d,{label:"操作",width:"200"},{default:_((e=>[e.row.edit?(f(),k(p,{key:0,size:"mini",type:"success",icon:"el-icon-check",onClick:t=>{return l=e.$index,o=e.row,console.log(l,o),void a("updateTask",l,n(r({},o),{edit:!1}));var l,o}},{default:_((()=>[E])),_:2},1032,["onClick"])):(f(),k(p,{key:1,size:"mini",icon:"el-icon-edit",onClick:t=>{return l=e.$index,o=e.row,console.log(l,o),void a("modifyTaskEdit",l,!0);var l,o}},{default:_((()=>[z])),_:2},1032,["onClick"])),b(g,{"confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定删除该条记录吗？",onConfirm:t=>{return l=e.$index,e.row,void a("deleteProjectTask",l);var l}},{reference:_((()=>[b(p,{size:"mini",icon:"el-icon-delete",type:"danger"},{default:_((()=>[$])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),w("div",D,[b(p,{onClick:t},{default:_((()=>[A])),_:1})])])}}});B.__scopeId="data-v-02e9e408";const q=e=>(S("data-v-0e80d769"),e=e(),C(),e),H={class:"board"},J={class:"board__info"},X=y("项目看板"),Z=q((()=>w("span",null,"项目看板主要应用场景：项目的任务管理，任务进度管理等。",-1))),F={class:"board__project"},G=q((()=>w("div",{class:"board__project-title"},"项目概览",-1))),K={class:"board__project-list"},Q=["onClick"],R={class:"board__detail"},W=q((()=>w("div",{class:"board__detail-title"},"项目详情",-1))),Y={key:0,class:"board__detail-empty"},ee={key:1,class:"board__detail-content"},ae={class:"board__detail-head"},te=q((()=>w("span",{class:"board__detail-name"},"项目名称",-1))),le=q((()=>w("span",{class:"board__detail-name"},"负责人",-1))),oe=q((()=>w("span",{class:"board__detail-name"},"开发工时",-1))),se=q((()=>w("span",{class:"board__detail-name"},"项目状态",-1))),de=q((()=>w("span",{class:"board__detail-name"},"任务总数",-1))),re=q((()=>w("span",{class:"board__detail-name"},"任务进度",-1))),ne=y("： "),ie={class:"board__detail-search"},ue=y("查询"),ce={class:"board__detail-table"};var pe=p({setup(e){const a=c({taskStatus:null,developMember:""}),t=new Map([["1",{text:"准备阶段",type:"info"}],["2",{text:"开发中",type:""}],["3",{text:"开发完成",type:"success"}],["4",{text:"测试阶段",type:"danger"}],["5",{text:"待发布",type:"warning"}]]),l=g([]),{store:o,updatedProjectInfo:s,addProjectTask:d,deleteTask:p,getProjectDetail:S,modifyTaskEdit:C}=(()=>{const e=c({data:[],target:{}});return u({url:"/api/project/list",method:"get",json:!0}).then((a=>{0===a.status&&(e.data=a.data,e.target=a.data[0])})),{store:e,updatedProjectInfo:function(a,t,l){const o=i.findIndex(e.data,["projectId",a]);e.data[o].taskList.splice(t,1,l)},addProjectTask:function(a,t){const l=i.findIndex(e.data,["projectId",a]);e.data[l].taskList.push(t)},deleteTask:function(a,t){const l=i.findIndex(e.data,["projectId",a]);e.data[l].taskList.splice(t,1)},getProjectDetail:function(a){return i.find(e.data,(e=>e.projectId===a))},modifyTaskEdit:function(a,t,l=!1){const o=i.findIndex(e.data,["projectId",a]),s=e.data[o].taskList;e.data[o].taskList=i.map(s,((e,a)=>t===a?n(r({},e),{edit:l}):e))}}})(),{data:L,target:U}=x(o);T((()=>U.value),(e=>{l.value=e.taskList}),{deep:!0});const O=V((()=>{const e=i.countBy(U.value.taskList,(e=>e.taskStatus));return i.map(Object.entries(e),(([e,a])=>{const l=t.get(e);return n(r({},l),{count:a})}))})),N=V((()=>{const e=i.map(U.value.taskList,(e=>e.developMember)).filter((e=>e));return i.uniq(e)}));function E(){console.log("search!",a);const e=a.taskStatus,t=a.developMember;if(e&&t){const a=i.map(U.value.taskList,(a=>{if(a.developMember===t&&a.taskStatus===e)return a})).filter((e=>e));l.value=a}else if(e){const a=i.map(U.value.taskList,(a=>{if(a.taskStatus===e)return a})).filter((e=>e));l.value=a}else if(t){const e=i.map(U.value.taskList,(e=>{if(e.developMember===t)return e})).filter((e=>e));l.value=e}else l.value=U.value.taskList}function z(e,a){const t=U.value.projectId;C(t,e,a),U.value=S(t)}function $(e,a){const t=U.value.projectId;s(t,e,a)}function D(){const e=U.value.projectId;d(e,{taskName:"",developTime:"",developMember:"",taskStatus:1,edit:!0})}function A(e){const a=U.value.projectId;p(a,e)}return(e,o)=>{const s=m("el-divider"),d=m("el-avatar"),r=m("el-col"),n=m("el-row"),i=m("el-card"),u=m("el-tag"),c=m("el-option"),p=m("el-select"),g=m("el-form-item"),x=m("el-button"),T=m("el-form");return f(),v("div",H,[w("div",J,[b(s,{"content-position":"left"},{default:_((()=>[X])),_:1}),Z]),w("div",F,[G,w("div",K,[(f(!0),v(I,null,h(M(L),((e,a)=>(f(),v("div",{key:a,class:P(["board__project-item",{"board__project-item--active":M(U).projectId===e.projectId}]),onClick:a=>{return t=e,void(U.value=t);var t}},[b(i,null,{default:_((()=>[b(n,null,{default:_((()=>[b(r,{span:5},{default:_((()=>[b(d,{class:"board__project-avatar",size:90},{default:_((()=>[y(j(e.projectName.substr(0,1)),1)])),_:2},1024)])),_:2},1024),b(r,{span:18,style:{"margin-left":"6px",color:"#7a848d"}},{default:_((()=>[w("p",null,"项目名称："+j(e.projectName),1),w("p",null,"总负责人："+j(e.principal),1),w("p",null,"开发耗时："+j(e.timeConsuming),1),w("p",null,"项目状态: "+j(e.status),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)],10,Q)))),128))])]),w("div",R,[W,b(i,{class:"board__detail-wrap"},{default:_((()=>[M(U).projectId?(f(),v("div",ee,[w("div",ae,[b(n,null,{default:_((()=>[b(r,{span:5},{default:_((()=>[te,y("："+j(M(U).projectName),1)])),_:1}),b(r,{span:5},{default:_((()=>[le,y("："+j(M(U).principal),1)])),_:1}),b(r,{span:5},{default:_((()=>[oe,y("："+j(M(U).timeConsuming),1)])),_:1}),b(r,{span:5},{default:_((()=>[se,y("："+j(M(U).status),1)])),_:1})])),_:1}),b(n,{class:"board__detail-task"},{default:_((()=>[b(r,{span:5},{default:_((()=>[de,y("："+j(M(U).taskList.length),1)])),_:1}),b(r,{span:18},{default:_((()=>[re,ne,(f(!0),v(I,null,h(M(O),((e,a)=>(f(),k(u,{key:a,class:"board__detail-tag",type:e.type},{default:_((()=>[y(j(e.text)+": "+j(e.count),1)])),_:2},1032,["type"])))),128))])),_:1})])),_:1})]),b(s),w("div",ie,[b(T,{inline:!0,model:M(a)},{default:_((()=>[b(g,{label:"开发人"},{default:_((()=>[b(p,{clearable:"",modelValue:M(a).developMember,"onUpdate:modelValue":o[0]||(o[0]=e=>M(a).developMember=e),placeholder:"选择任务开发者"},{default:_((()=>[(f(!0),v(I,null,h(M(N),((e,a)=>(f(),k(c,{key:a,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),b(g,{label:"任务状态"},{default:_((()=>[b(p,{clearable:"",modelValue:M(a).taskStatus,"onUpdate:modelValue":o[1]||(o[1]=e=>M(a).taskStatus=e),placeholder:"选择任务状态"},{default:_((()=>[b(c,{label:"准备阶段",value:1}),b(c,{label:"开发中",value:2}),b(c,{label:"开发完成",value:3}),b(c,{label:"测试阶段",value:4}),b(c,{label:"待发布",value:5})])),_:1},8,["modelValue"])])),_:1}),b(g,null,{default:_((()=>[b(x,{type:"primary",onClick:E},{default:_((()=>[ue])),_:1})])),_:1})])),_:1},8,["model"])]),w("div",ce,[b(B,{data:l.value,status:M(t),onUpdateTask:$,onModifyTaskEdit:z,onAddProjectTask:D,onDeleteProjectTask:A},null,8,["data","status"])])])):(f(),v("div",Y,"请选择项目，查看项目详情！！！"))])),_:1})])])}}});pe.__scopeId="data-v-0e80d769";export{pe as default};
