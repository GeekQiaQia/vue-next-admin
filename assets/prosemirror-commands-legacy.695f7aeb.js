System.register(["./prosemirror-transform-legacy.b5eacd4e.js","./prosemirror-model-legacy.4a10d9e7.js","./prosemirror-state-legacy.1039d02f.js"],(function(e){"use strict";var t,r,n,o,i,a,c,l,s,f,p;return{setters:[function(e){t=e.f,r=e.l,n=e.c,o=e.R,i=e.b},function(e){a=e.F,c=e.a},function(e){l=e.S,s=e.A,f=e.N,p=e.T}],execute:function(){function d(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function u(e,t){for(;e;e="start"==t?e.firstChild:e.lastChild)if(e.isTextblock)return!0;return!1}function v(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function m(e,t,r){var n=e.selection.$cursor;if(!n||(r?!r.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size))return!1;var o=h(n);if(!o)return!1;var i=o.nodeAfter;if(b(e,o,t))return!0;if(0==n.parent.content.size&&(u(i,"start")||f.isSelectable(i))){if(t){var a=e.tr.deleteRange(n.before(),n.after());a.setSelection(u(i,"start")?l.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):f.create(a.doc,a.mapping.map(o.pos))),t(a.scrollIntoView())}return!0}return!(!i.isAtom||o.depth!=n.depth-1||(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),0))}function h(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var r=e.node(t);if(e.index(t)+1<r.childCount)return e.doc.resolve(e.after(t+1));if(r.type.spec.isolating)break}return null}function g(e,t){var r=e.selection,n=r.$head,o=r.$anchor;return!(!n.parent.type.spec.code||!n.sameParent(o)||(t&&t(e.tr.insertText("\n").scrollIntoView()),0))}function k(e){for(var t=0;t<e.edgeCount;t++){var r=e.edge(t).type;if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function y(e,t){var r=e.selection,n=r.$head,o=r.$anchor;if(!n.parent.type.spec.code||!n.sameParent(o))return!1;var i=n.node(-1),a=n.indexAfter(-1),c=k(i.contentMatchAt(a));if(!i.canReplaceWith(a,a,c))return!1;if(t){var s=n.after(),f=e.tr.replaceWith(s,s,c.createAndFill());f.setSelection(l.near(f.doc.resolve(s),1)),t(f.scrollIntoView())}return!0}function w(e,t){return t&&t(e.tr.setSelection(new s(e.doc))),!0}function b(e,t,n){var s,f,p=t.nodeBefore,d=t.nodeAfter;if(p.type.spec.isolating||d.type.spec.isolating)return!1;if(function(e,t,r){var n=t.nodeBefore,o=t.nodeAfter,a=t.index();return!(!(n&&o&&n.type.compatibleContent(o.type))||(!n.content.size&&t.parent.canReplace(a-1,a)?(r&&r(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(a,a+1)||!o.isTextblock&&!i(e.doc,t.pos)||(r&&r(e.tr.clearIncompatible(t.pos,n.type,n.contentMatchAt(n.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;var v=t.parent.canReplace(t.index(),t.index()+1);if(v&&(s=(f=p.contentMatchAt(p.childCount)).findWrapping(d.type))&&f.matchType(s[0]||d.type).validEnd){if(n){for(var m=t.pos+d.nodeSize,h=a.empty,g=s.length-1;g>=0;g--)h=a.from(s[g].create(null,h));h=a.from(p.copy(h));var k=e.tr.step(new o(t.pos-1,m,t.pos,m,new c(h,1,0),s.length,!0)),y=m+2*s.length;i(k.doc,y)&&k.join(y),n(k.scrollIntoView())}return!0}var w=l.findFrom(t,1),b=w&&w.$from.blockRange(w.$to),x=b&&r(b);if(null!=x&&x>=t.depth)return n&&n(e.tr.lift(b,x).scrollIntoView()),!0;if(v&&d.isTextblock&&u(p,"end")){for(var S=p,I=[];I.push(S),!S.isTextblock;)S=S.lastChild;if(S.canReplace(S.childCount,S.childCount,d.content)){if(n){for(var $=a.empty,M=I.length-1;M>=0;M--)$=a.from(I[M].copy($));n(e.tr.step(new o(t.pos-I.length,t.pos+d.nodeSize,t.pos+1,t.pos+d.nodeSize-1,new c($,I.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function x(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t,r,n){for(var o=0;o<e.length;o++)if(e[o](t,r,n))return!0;return!1}}e({a:w,c:x,d:d,e:y,j:m,n:g,s:function(e,t){return function(r,n){var o=r.selection,i=o.from,a=o.to,c=!1;return r.doc.nodesBetween(i,a,(function(n,o){if(c)return!1;if(n.isTextblock&&!n.hasMarkup(e,t))if(n.type==e)c=!0;else{var i=r.doc.resolve(o),a=i.index();c=i.parent.canReplaceWith(a,a+1,e)}})),!!c&&(n&&n(r.tr.setBlockType(i,a,e,t).scrollIntoView()),!0)}},t:function(e,t){return function(r,n){var o=r.selection,i=o.empty,a=o.$cursor,c=o.ranges;if(i&&!a||!function(e,t,r){for(var n=function(n){var o=t[n],i=o.$from,a=o.$to,c=0==i.depth&&e.type.allowsMarkType(r);if(e.nodesBetween(i.pos,a.pos,(function(e){if(c)return!1;c=e.inlineContent&&e.type.allowsMarkType(r)})),c)return{v:!0}},o=0;o<t.length;o++){var i=n(o);if(i)return i.v}return!1}(r.doc,c,e))return!1;if(n)if(a)e.isInSet(r.storedMarks||a.marks())?n(r.tr.removeStoredMark(e)):n(r.tr.addStoredMark(e.create(t)));else{for(var l=!1,s=r.tr,f=0;!l&&f<c.length;f++){var p=c[f],d=p.$from,u=p.$to;l=r.doc.rangeHasMark(d.pos,u.pos,e)}for(var v=0;v<c.length;v++){var m=c[v],h=m.$from,g=m.$to;if(l)s.removeMark(h.pos,g.pos,e);else{var k=h.pos,y=g.pos,w=h.nodeAfter,b=g.nodeBefore,x=w&&w.isText?/^\s*/.exec(w.text)[0].length:0,S=b&&b.isText?/\s*$/.exec(b.text)[0].length:0;k+x<y&&(k+=x,y-=S),s.addMark(k,y,e.create(t))}}n(s.scrollIntoView())}return!0}},w:function(e,r){return function(n,o){var i=n.selection,a=i.$from,c=i.$to,l=a.blockRange(c),s=l&&t(l,e,r);return!!s&&(o&&o(n.tr.wrap(l,s).scrollIntoView()),!0)}}});var S=x(d,(function(e,t,n){var o=e.selection.$cursor;if(!o||(n?!n.endOfTextblock("backward",e):o.parentOffset>0))return!1;var i=v(o);if(!i){var a=o.blockRange(),c=a&&r(a);return null!=c&&(t&&t(e.tr.lift(a,c).scrollIntoView()),!0)}var s=i.nodeBefore;if(!s.type.spec.isolating&&b(e,i,t))return!0;if(0==o.parent.content.size&&(u(s,"end")||f.isSelectable(s))){if(t){var p=e.tr.deleteRange(o.before(),o.after());p.setSelection(u(s,"end")?l.findFrom(p.doc.resolve(p.mapping.map(i.pos,-1)),-1):f.create(p.doc,i.pos-s.nodeSize)),t(p.scrollIntoView())}return!0}return!(!s.isAtom||i.depth!=o.depth-1||(t&&t(e.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),0))}),(function(e,t,r){var n=e.selection,o=n.$head,i=o;if(!n.empty)return!1;if(o.parent.isTextblock){if(r?!r.endOfTextblock("backward",e):o.parentOffset>0)return!1;i=v(o)}var a=i&&i.nodeBefore;return!(!a||!f.isSelectable(a)||(t&&t(e.tr.setSelection(f.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),0))})),I=x(d,m,(function(e,t,r){var n=e.selection,o=n.$head,i=o;if(!n.empty)return!1;if(o.parent.isTextblock){if(r?!r.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;i=h(o)}var a=i&&i.nodeAfter;return!(!a||!f.isSelectable(a)||(t&&t(e.tr.setSelection(f.create(e.doc,i.pos)).scrollIntoView()),0))})),$={Enter:x(g,(function(e,t){var r=e.selection,n=r.$from,o=r.$to;if(r instanceof s||n.parent.inlineContent||o.parent.inlineContent)return!1;var i=k(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){var a=(!n.parentOffset&&o.index()<o.parent.childCount?n:o).pos,c=e.tr.insert(a,i.createAndFill());c.setSelection(p.create(c.doc,a+1)),t(c.scrollIntoView())}return!0}),(function(e,t){var o=e.selection.$cursor;if(!o||o.parent.content.size)return!1;if(o.depth>1&&o.after()!=o.end(-1)){var i=o.before();if(n(e.doc,i))return t&&t(e.tr.split(i).scrollIntoView()),!0}var a=o.blockRange(),c=a&&r(a);return null!=c&&(t&&t(e.tr.lift(a,c).scrollIntoView()),!0)}),(function(e,t){var r=e.selection,o=r.$from,i=r.$to;if(e.selection instanceof f&&e.selection.node.isBlock)return!(!o.parentOffset||!n(e.doc,o.pos)||(t&&t(e.tr.split(o.pos).scrollIntoView()),0));if(!o.parent.isBlock)return!1;if(t){var a=i.parentOffset==i.parent.content.size,c=e.tr;(e.selection instanceof p||e.selection instanceof s)&&c.deleteSelection();var l=0==o.depth?null:k(o.node(-1).contentMatchAt(o.indexAfter(-1))),d=a&&l?[{type:l}]:null,u=n(c.doc,c.mapping.map(o.pos),1,d);if(d||u||!n(c.doc,c.mapping.map(o.pos),1,l&&[{type:l}])||(d=[{type:l}],u=!0),u&&(c.split(c.mapping.map(o.pos),1,d),!a&&!o.parentOffset&&o.parent.type!=l)){var v=c.mapping.map(o.before()),m=c.doc.resolve(v);o.node(-1).canReplaceWith(m.index(),m.index()+1,l)&&c.setNodeMarkup(c.mapping.map(o.before()),l)}t(c.scrollIntoView())}return!0})),"Mod-Enter":y,Backspace:S,"Mod-Backspace":S,Delete:I,"Mod-Delete":I,"Mod-a":w},M={"Ctrl-h":$.Backspace,"Alt-Backspace":$["Mod-Backspace"],"Ctrl-d":$.Delete,"Ctrl-Alt-Backspace":$["Mod-Delete"],"Alt-Delete":$["Mod-Delete"],"Alt-d":$["Mod-Delete"]};for(var A in $)M[A]=$[A];var V="undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform();e("b",V?M:$)}}}));
