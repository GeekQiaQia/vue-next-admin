var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,n=(e,a)=>{for(var l in a||(a={}))s.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e},i=(e,t)=>a(e,l(t));import{d as u,a1 as d,c,p as m,b as p,q as f,v as b,_ as g,i as _,g as v,h,w as y,m as k,t as C,L as w,M as N,a0 as j,ah as z,ai as R,bt as S,az as V,R as x,ay as O,b8 as P,r as E,aF as D,bl as M,bs as T,br as U,aK as F,y as $,k as q,a4 as A,bu as B,x as I,ax as L,aQ as K,b5 as Q,X,aR as Z,bd as G,a$ as H,aZ as J,N as W}from"./vendor.fe54199a.js";/* empty css                *//* empty css               *//* empty css            *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                       */import{r as Y,u as ee,_ as ae}from"./index.b25652b5.js";const le="/api/auth/permission/routes";const te=u({name:"RolesEdit",props:{currentRole:{type:Object,default:()=>({roleName:"",state:1})}},emits:["success"],setup(e,{emit:a}){const l=d(e,"currentRole"),t=ee(),s=c((()=>t.getters["settingsModule/getLangState"])),o=m({url:"/role/allow",purl:"/role/permissions",loading:!1,form:{key:"",label:""},menu:{loading:!1,url:"/menu/list",data:[],form:[]}}),r=c((()=>l.value.role)),u=c((()=>t.state.permissionModule.routes)),g=async()=>{const e={roleName:r.value.roleName},a=await class{static postAuthPermission(e){return Y({url:le,method:"POST",json:!0,data:e}).then((e=>(console.log(e),0===e.status?Promise.resolve(e):Promise.reject(e))))}}.postAuthPermission(e);if(null==a?void 0:a.data){const{authedRoutes:e}=a.data;o.menu.form=e}},_=()=>{var e,a;for(const l of u.value)(null==(e=null==l?void 0:l.meta)?void 0:e.hidden)||o.menu.data.push({key:null==l?void 0:l.path,label:null==(a=null==l?void 0:l.meta)?void 0:a.title[s.value]})};return p((()=>{_()})),f((()=>{g()})),i(n({},b(o)),{lang:s,role:r,fetchMenuData:_,saveData:()=>{console.log("form is ",o.menu.form),a("success")}})}}),se=e=>(w("data-v-7247ff70"),e=e(),N(),e),oe={class:"wrapper"},re={class:"card-header"},ne=se((()=>k("br",null,null,-1))),ie=se((()=>k("i",{class:"fa fa-check"},null,-1))),ue=j(" 确认修改 ");var de=ae(te,[["render",function(e,a,l,t,s,o){const r=z,n=R,i=S,u=V,d=x,c=O,m=P;return g((_(),v("div",oe,[h(u,{class:"transfer"},{header:y((()=>[k("span",null,[k("div",re,[h(n,{"label-position":"left",inline:"",class:"info-table"},{default:y((()=>[h(r,{label:"名称"},{default:y((()=>[k("span",null,C(e.role.roleName),1)])),_:1})])),_:1})])])])),default:y((()=>[g(h(i,{modelValue:e.menu.form,"onUpdate:modelValue":a[0]||(a[0]=a=>e.menu.form=a),data:e.menu.data,titles:["菜单","已授权"]},null,8,["modelValue","data"]),[[m,e.menu.loading]])])),_:1}),ne,h(c,{class:"btns"},{default:y((()=>[h(d,{size:"mini",type:"primary",disabled:0==e.role.state,onClick:e.saveData},{default:y((()=>[ie,ue])),_:1},8,["disabled","onClick"])])),_:1})])),[[m,e.loading]])}],["__scopeId","data-v-7247ff70"]]);const ce=u({name:"RoleNew",emits:["success"],setup(e,{emit:a}){const l=E(),t=m({form:{roleName:"",remark:""},loading:!1});return n({submitForm:()=>{l.value.validate((e=>e?(a("success",n({},t.form)),!0):(console.log("error submit!!"),!1)))},rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}]},formRef:l,url:"/role/add"},b(t))}}),me={class:"new"},pe=k("i",{class:"fa fa-plus"},null,-1),fe=j(" 新增 ");const be=u({name:"RoleManage",components:{RoleEdit:de,RoleNew:ae(ce,[["render",function(e,a,l,t,s,o){const r=D,n=z,i=x,u=O,d=R,c=P;return g((_(),v("div",me,[h(d,{ref:"formRef",model:e.form,rules:e.rules,"label-position":"right","label-width":"100px"},{default:y((()=>[h(n,{label:"角色名称",prop:"roleName"},{default:y((()=>[h(r,{modelValue:e.form.roleName,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.roleName=a),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),h(n,{label:"备注"},{default:y((()=>[h(r,{modelValue:e.form.remark,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.remark=a),placeholder:"请输入备注"},null,8,["modelValue"])])),_:1}),h(u,{class:"btn-container"},{default:y((()=>[h(i,{size:"mini",type:"primary",onClick:a[2]||(a[2]=a=>e.submitForm())},{default:y((()=>[pe,fe])),_:1})])),_:1})])),_:1},8,["model","rules"])])),[[c,e.loading]])}]]),Edit:M,Minus:T,Plus:U,Refresh:F},setup(){const e=m({url:{c:"/role/add",r:"/role/list",u:"/role/update",d:"/role/delete"},param:{limit:10,page:1},data:[{roleName:"超级管理员",remark:"拥有删除和创建等操作的权限",state:0},{roleName:"管理员",remark:"拥有创建和权限分配的权限",state:0},{roleName:"游客",remark:"只拥有操作部分菜单的权限",state:1}],loading:!1,is_search:!1,add_visible:!1,edit_visible:!1,detail_visible:!1,posted:{role:{roleName:"",state:1}}}),a=c((()=>e.data.length));return i(n({},b(e)),{total:a,onCurrentChange:()=>{},onSizeChange:a=>{e.param.limit=a},onCreate:()=>{e.add_visible=!0},onCreateSuccess:a=>{console.log(a);const l={roleName:a.roleName,remark:a.remark,state:1};e.data.push(l),e.add_visible=!1},onEditSuccess:()=>{e.edit_visible=!1},onRefresh:()=>{e.is_search=!1},onEdit:(a,l)=>{console.log("row",l),e.posted.role=l,e.edit_visible=!0},onDelete:(e,a)=>{console.log(e,a),(e=>{console.log(e),J.confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{W({type:"success",message:"删除成功"})})).catch((()=>{W({type:"info",message:"已取消删除"})}))})(e)}})}}),ge=j(" 新增"),_e=j(" 刷新"),ve=k("br",null,null,-1),he=k("i",{class:"ic ic-lock"},null,-1),ye=j(" 锁定"),ke=j("正常"),Ce=j("未知"),we={class:"pagination"};var Ne=ae(be,[["render",function(e,a,l,t,s,o){const r=B,n=$("plus"),i=I,u=x,d=$("refresh"),c=L,m=O,p=K,f=Q,b=$("edit"),C=X,w=$("minus"),N=Z,j=G,z=V,R=$("role-edit"),S=H,E=$("role-new"),D=P;return _(),v("div",null,[h(r,{title:"Tips:点击【新增】按钮进行新增角色；点击【编辑】按钮，进行不同角色的菜单授权操作！",type:"warning"}),h(r,{title:"Tips:权限控制体验：【管理员账号为：admin@outlook.com】、【超级管理员账号为：super@outlook.com】",type:"info"}),h(z,{class:"card-ctrl"},{default:y((()=>[h(m,null,{default:y((()=>[h(c,{span:8,style:{"text-align":"left"}},{default:y((()=>[h(u,{type:"primary",size:"small",onClick:e.onCreate},{default:y((()=>[h(i,null,{default:y((()=>[h(n)])),_:1}),ge])),_:1},8,["onClick"]),h(u,{type:"success",size:"small",onClick:e.onRefresh},{default:y((()=>[h(i,null,{default:y((()=>[h(d)])),_:1}),_e])),_:1},8,["onClick"])])),_:1})])),_:1}),ve,g((_(),q(N,{data:e.data,stripe:"",class:"table"},{default:y((()=>[h(p,{prop:"roleName",label:"角色名称",align:"center"}),h(p,{prop:"state",label:"角色状态",align:"center"},{default:y((e=>[0==e.row.state?(_(),q(f,{key:0,size:"mini",type:"info"},{default:y((()=>[he,ye])),_:1})):1==e.row.state?(_(),q(f,{key:1,size:"mini",type:"success"},{default:y((()=>[ke])),_:1})):(_(),q(f,{key:2,size:"mini",type:"danger"},{default:y((()=>[Ce])),_:1}))])),_:1}),h(p,{prop:"remark",label:"备注",align:"center"}),h(p,{label:"操作",align:"center"},{default:y((a=>[h(C,{class:"item",effect:"dark",content:"菜单授权",placement:"bottom"},{default:y((()=>[h(u,{circle:"",plain:"",type:"primary",size:"small",onClick:l=>e.onEdit(a.$index,a.row)},{default:y((()=>[h(i,null,{default:y((()=>[h(b)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024),0!=a.row.state?(_(),q(C,{key:0,class:"item",effect:"dark",content:"删除",placement:"bottom"},{default:y((()=>[h(u,{circle:"",plain:"",type:"danger",size:"small",onClick:l=>e.onDelete(a.$index,a.row)},{default:y((()=>[h(i,null,{default:y((()=>[h(w)])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)):A("",!0)])),_:1})])),_:1},8,["data"])),[[D,e.loading]]),k("div",we,[h(j,{"current-page":e.param.page,"page-size":e.param.limit,layout:"sizes,prev,pager,next,total","page-sizes":[5,10,20],total:e.total,background:"",onCurrentChange:e.onCurrentChange,onSizeChange:e.onSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])])),_:1}),h(S,{modelValue:e.edit_visible,"onUpdate:modelValue":a[0]||(a[0]=a=>e.edit_visible=a),center:"",title:e.posted.role.roleName},{default:y((()=>[h(R,{"current-role":e.posted,onSuccess:e.onEditSuccess},null,8,["current-role","onSuccess"])])),_:1},8,["modelValue","title"]),h(S,{modelValue:e.add_visible,"onUpdate:modelValue":a[1]||(a[1]=a=>e.add_visible=a),title:"新增角色"},{default:y((()=>[h(E,{onSuccess:e.onCreateSuccess},null,8,["onSuccess"])])),_:1},8,["modelValue"])])}]]);export{Ne as default};
