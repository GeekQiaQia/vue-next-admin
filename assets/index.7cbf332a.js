var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,d=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,n=(e,a)=>{for(var t in a||(a={}))o.call(a,t)&&d(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&d(e,t,a[t]);return e},r=(e,l)=>a(e,t(l));import{_ as u}from"./lodash.0c8485ed.js";import{r as i}from"./index.521a23a7.js";import{r as c,d as p,k as v,e as m,c as f,s as _,q as b,m as k,v as y,I as j,g as w,y as g,w as I,i as T,F as V,t as x,n as P,bm as h,p as M,f as S}from"./vendor.67cd59db.js";const L={class:"task-table"},C={key:1},U={key:1},O={key:1},N=j("保存"),E=j("编辑"),$=j("删除"),z={class:"task-table__add"},D=j("+ 新增任务");var q=p({props:{data:null,status:null},emits:["updateTask","modifyTaskEdit","addProjectTask","deleteProjectTask"],setup(e,{emit:a}){function t(){a("addProjectTask")}return(l,o)=>{const s=v("el-input"),d=v("el-table-column"),n=v("el-option"),r=v("el-select"),u=v("el-tag"),i=v("el-button"),c=v("el-popconfirm"),p=v("el-table");return m(),f("div",L,[_(p,{data:e.data,style:{width:"100%"}},{default:b((()=>[_(d,{prop:"taskName",label:"任务名称"},{default:b((e=>[e.row.edit?(m(),k(s,{key:0,modelValue:e.row.taskName,"onUpdate:modelValue":a=>e.row.taskName=a},null,8,["modelValue","onUpdate:modelValue"])):(m(),f("span",C,y(e.row.taskName),1))])),_:1}),_(d,{prop:"developTime",label:"开发工时"},{default:b((e=>[e.row.edit?(m(),k(s,{key:0,modelValue:e.row.developTime,"onUpdate:modelValue":a=>e.row.developTime=a},null,8,["modelValue","onUpdate:modelValue"])):(m(),f("span",U,y(e.row.developTime),1))])),_:1}),_(d,{prop:"developMember",label:"开发人"},{default:b((e=>[e.row.edit?(m(),k(s,{key:0,modelValue:e.row.developMember,"onUpdate:modelValue":a=>e.row.developMember=a},null,8,["modelValue","onUpdate:modelValue"])):(m(),f("span",O,y(e.row.developMember),1))])),_:1}),_(d,{prop:"taskStatus",label:"任务状态"},{default:b((a=>{var t;return[a.row.edit?(m(),k(r,{key:0,modelValue:a.row.taskStatus,"onUpdate:modelValue":e=>a.row.taskStatus=e,placeholder:"选择任务状态"},{default:b((()=>[_(n,{label:"准备阶段",value:1}),_(n,{label:"开发中",value:2}),_(n,{label:"开发完成",value:3}),_(n,{label:"测试阶段",value:4}),_(n,{label:"待发布",value:5})])),_:2},1032,["modelValue","onUpdate:modelValue"])):(m(),k(u,{key:1,type:null==(t=e.status.get(`${a.row.taskStatus}`))?void 0:t.type},{default:b((()=>{var t;return[j(y(null==(t=e.status.get(`${a.row.taskStatus}`))?void 0:t.text),1)]})),_:2},1032,["type"]))]})),_:1}),_(d,{label:"操作",width:"200"},{default:b((e=>[e.row.edit?(m(),k(i,{key:0,size:"mini",type:"success",icon:"el-icon-check",onClick:t=>{return l=e.$index,o=e.row,console.log(l,o),a("updateTask",l,o),void a("modifyTaskEdit",l,!1);var l,o}},{default:b((()=>[N])),_:2},1032,["onClick"])):(m(),k(i,{key:1,size:"mini",icon:"el-icon-edit",onClick:t=>{return l=e.$index,o=e.row,console.log(l,o),void a("modifyTaskEdit",l,!0);var l,o}},{default:b((()=>[E])),_:2},1032,["onClick"])),_(c,{"confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定删除该条记录吗？",onConfirm:t=>{return l=e.$index,e.row,void a("deleteProjectTask",l);var l}},{reference:b((()=>[_(i,{size:"mini",icon:"el-icon-delete",type:"danger"},{default:b((()=>[$])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),w("div",z,[_(i,{onClick:t},{default:b((()=>[D])),_:1})])])}}});q.__scopeId="data-v-105cac7b";const A=e=>(M("data-v-11334159"),e=e(),S(),e),B={class:"board"},F={class:"board__info"},G=j("项目看板"),H=A((()=>w("span",null,"项目看板主要应用场景：项目的任务管理，任务进度管理等。",-1))),J={class:"board__project"},K=A((()=>w("div",{class:"board__project-title"},"项目概览",-1))),Q={class:"board__project-list"},R=["onClick"],W={class:"board__detail"},X=A((()=>w("div",{class:"board__detail-title"},"项目详情",-1))),Y={key:0,class:"board__detail-empty"},Z={key:1,class:"board__detail-content"},ee={class:"board__detail-head"},ae=A((()=>w("span",{class:"board__detail-name"},"项目名称",-1))),te=A((()=>w("span",{class:"board__detail-name"},"负责人",-1))),le=A((()=>w("span",{class:"board__detail-name"},"开发工时",-1))),oe=A((()=>w("span",{class:"board__detail-name"},"项目状态",-1))),se=A((()=>w("span",{class:"board__detail-name"},"任务总数",-1))),de=A((()=>w("span",{class:"board__detail-name"},"任务进度",-1))),ne=j("： "),re={class:"board__detail-search"},ue=j("查询"),ie={class:"board__detail-table"};var ce=p({setup(e){const a=g({taskStatus:null,developMember:""}),t=new Map([["1",{text:"准备阶段",type:"info"}],["2",{text:"开发中",type:""}],["3",{text:"开发完成",type:"success"}],["4",{text:"测试阶段",type:"danger"}],["5",{text:"待发布",type:"warning"}]]),l=c({}),o=c([]),{data:s,getProjectInfo:d,updatedProjectInfo:p,addProjectTask:M,deleteTask:S,getProjectDetail:L,modifyTaskEdit:C}=(()=>{const e=c([]);return{data:e,getProjectInfo:function(){return i({url:"/api/project/list",method:"get",json:!0}).then((a=>{0===a.status&&(e.value=a.data)}))},updatedProjectInfo:function(a,t,l){const o=u.findIndex(e.value,["projectId",a]);e.value[o].taskList.splice(t,1,l)},addProjectTask:function(a,t){const l=u.findIndex(e.value,["projectId",a]);e.value[l].taskList.push(t)},deleteTask:function(a,t){const l=u.findIndex(e.value,["projectId",a]);e.value[l].taskList.splice(t,1)},getProjectDetail:function(a){return u.find(e.value,(e=>e.projectId===a))},modifyTaskEdit:function(a,t,l=!1){const o=u.findIndex(e.value,["projectId",a]),s=e.value[o].taskList;e.value[o].taskList=u.map(s,((e,a)=>t===a?r(n({},e),{edit:l}):e))}}})();d().then((()=>{l.value=s.value[0]})),I((()=>l.value),(e=>{o.value=e.taskList}),{deep:!0});const U=T((()=>{const e=u.map(l.value.taskList,(e=>e.developMember)).filter((e=>e));return u.uniq(e)}));function O(e){const a=u.countBy(e,(e=>e.taskStatus));return u.map(Object.entries(a),(([e,a])=>{const l=t.get(e);return r(n({},l),{count:a})}))}function N(){console.log("search!",a);const e=a.taskStatus,t=a.developMember;if(e&&t){const a=u.map(l.value.taskList,(a=>{if(a.developMember===t&&a.taskStatus===e)return a})).filter((e=>e));o.value=a}else if(e){const a=u.map(l.value.taskList,(a=>{if(a.taskStatus===e)return a})).filter((e=>e));o.value=a}else if(t){const e=u.map(l.value.taskList,(e=>{if(e.developMember===t)return e})).filter((e=>e));o.value=e}else o.value=l.value.taskList}function E(e,a){const t=l.value.projectId;C(t,e,a),l.value=L(t)}function $(e,a){const t=l.value.projectId;p(t,e,a)}function z(){const e=l.value.projectId;M(e,{taskName:"",developTime:"",developMember:"",taskStatus:1,edit:!0})}function D(e){const a=l.value.projectId;S(a,e)}return(e,d)=>{const n=v("el-divider"),r=v("el-avatar"),u=v("el-col"),i=v("el-row"),c=v("el-card"),p=v("el-tag"),g=v("el-option"),I=v("el-select"),T=v("el-form-item"),M=v("el-button"),S=v("el-form");return m(),f("div",B,[w("div",F,[_(n,{"content-position":"left"},{default:b((()=>[G])),_:1}),H]),w("div",J,[K,w("div",Q,[(m(!0),f(V,null,x(h(s),((e,a)=>(m(),f("div",{key:a,class:P(["board__project-item",{"board__project-item--active":l.value.projectId===e.projectId}]),onClick:a=>{return t=e,void(l.value=t);var t}},[_(c,null,{default:b((()=>[_(i,null,{default:b((()=>[_(u,{span:5},{default:b((()=>[_(r,{class:"board__project-avatar",size:90},{default:b((()=>[j(y(e.projectName.substr(0,1)),1)])),_:2},1024)])),_:2},1024),_(u,{span:18,style:{"margin-left":"6px",color:"#7a848d"}},{default:b((()=>[w("p",null,"项目名称："+y(e.projectName),1),w("p",null,"总负责人："+y(e.principal),1),w("p",null,"开发耗时："+y(e.timeConsuming),1),w("p",null,"项目状态: "+y(e.status),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)],10,R)))),128))])]),w("div",W,[X,_(c,{class:"board__detail-wrap"},{default:b((()=>[l.value.projectId?(m(),f("div",Z,[w("div",ee,[_(i,null,{default:b((()=>[_(u,{span:5},{default:b((()=>[ae,j("："+y(l.value.projectName),1)])),_:1}),_(u,{span:5},{default:b((()=>[te,j("："+y(l.value.principal),1)])),_:1}),_(u,{span:5},{default:b((()=>[le,j("："+y(l.value.timeConsuming),1)])),_:1}),_(u,{span:5},{default:b((()=>[oe,j("："+y(l.value.status),1)])),_:1})])),_:1}),_(i,{class:"board__detail-task"},{default:b((()=>[_(u,{span:5},{default:b((()=>[se,j("："+y(l.value.taskList.length),1)])),_:1}),_(u,{span:18},{default:b((()=>[de,ne,(m(!0),f(V,null,x(O(l.value.taskList),((e,a)=>(m(),k(p,{key:a,class:"board__detail-tag",type:e.type},{default:b((()=>[j(y(e.text)+": "+y(e.count),1)])),_:2},1032,["type"])))),128))])),_:1})])),_:1})]),_(n),w("div",re,[_(S,{inline:!0,model:h(a)},{default:b((()=>[_(T,{label:"开发人"},{default:b((()=>[_(I,{clearable:"",modelValue:h(a).developMember,"onUpdate:modelValue":d[0]||(d[0]=e=>h(a).developMember=e),placeholder:"选择任务开发者"},{default:b((()=>[(m(!0),f(V,null,x(h(U),((e,a)=>(m(),k(g,{key:a,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),_(T,{label:"任务状态"},{default:b((()=>[_(I,{clearable:"",modelValue:h(a).taskStatus,"onUpdate:modelValue":d[1]||(d[1]=e=>h(a).taskStatus=e),placeholder:"选择任务状态"},{default:b((()=>[_(g,{label:"准备阶段",value:1}),_(g,{label:"开发中",value:2}),_(g,{label:"开发完成",value:3}),_(g,{label:"测试阶段",value:4}),_(g,{label:"待发布",value:5})])),_:1},8,["modelValue"])])),_:1}),_(T,null,{default:b((()=>[_(M,{type:"primary",onClick:N},{default:b((()=>[ue])),_:1})])),_:1})])),_:1},8,["model"])]),w("div",ie,[_(q,{data:o.value,status:h(t),onUpdateTask:$,onModifyTaskEdit:E,onAddProjectTask:z,onDeleteProjectTask:D},null,8,["data","status"])])])):(m(),f("div",Y,"请选择项目，查看项目详情！！！"))])),_:1})])])}}});ce.__scopeId="data-v-11334159";export{ce as default};
