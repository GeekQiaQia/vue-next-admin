var Q=Object.defineProperty,W=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var P=(e,t,n)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D=(e,t)=>{for(var n in t||(t={}))Y.call(t,n)&&P(e,n,t[n]);if(M)for(var n of M(t))Z.call(t,n)&&P(e,n,t[n]);return e},y=(e,t)=>W(e,X(t));import{r as x,u as ee,_ as A}from"./index.0d1898b4.js";import{d as $,O as oe,j as v,A as w,c as te,B as ue,C as N,s as l,as as S,L as B,f as b,e as V,t as o,m as u,h,x as le,p as ne,g as se,N as E,r as ae,av as re,aw as ie,ax as ce,ad as de,k as F,P as me,an as _e,H as T}from"./vendor.6752bb16.js";const pe={queryAuthedPermission:"/api/auth/permission/routes"};class fe{static postAuthPermission(t){return x({url:pe.queryAuthedPermission,method:"POST",json:!0,data:t}).then(n=>(console.log(n),n.status===0?Promise.resolve(n):Promise.reject(n)))}}const ge=$({name:"RolesEdit",props:{currentRole:{type:Object,default:()=>({roleName:"",state:1})}},emits:["success"],setup(e,{emit:t}){const n=oe(e,"currentRole"),C=ee(),g=v(()=>C.getters["settingsModule/getLangState"]),m=w({url:"/role/allow",purl:"/role/permissions",loading:!1,form:{key:"",label:""},menu:{loading:!1,url:"/menu/list",data:[],form:[]}}),c=v(()=>n.value.role),_=v(()=>C.state.permissionModule.routes),p=async()=>{const r={roleName:c.value.roleName},i=await fe.postAuthPermission(r);if(i!=null&&i.data){const{authedRoutes:s}=i.data;m.menu.form=s}},d=()=>{var r,i;for(const s of _.value)(r=s==null?void 0:s.meta)!=null&&r.hidden||m.menu.data.push({key:s==null?void 0:s.path,label:(i=s==null?void 0:s.meta)==null?void 0:i.title[g.value]})},a=()=>{console.log("form is ",m.menu.form),t("success")};return te(()=>{d()}),ue(()=>{p()}),y(D({},N(m)),{lang:g,role:c,fetchMenuData:d,saveData:a})}}),U=e=>(ne("data-v-7247ff70"),e=e(),se(),e),Ce={class:"wrapper"},he={class:"card-header"},be=U(()=>h("br",null,null,-1)),Ee=U(()=>h("i",{class:"fa fa-check"},null,-1)),De=E(" \u786E\u8BA4\u4FEE\u6539 ");function Fe(e,t,n,C,g,m){const c=l("el-form-item"),_=l("el-form"),p=l("el-transfer"),d=l("el-card"),a=l("el-button"),r=l("el-row"),i=S("loading");return B((b(),V("div",Ce,[o(d,{class:"transfer"},{header:u(()=>[h("span",null,[h("div",he,[o(_,{"label-position":"left",inline:"",class:"info-table"},{default:u(()=>[o(c,{label:"\u540D\u79F0"},{default:u(()=>[h("span",null,le(e.role.roleName),1)]),_:1})]),_:1})])])]),default:u(()=>[B(o(p,{modelValue:e.menu.form,"onUpdate:modelValue":t[0]||(t[0]=s=>e.menu.form=s),data:e.menu.data,titles:["\u83DC\u5355","\u5DF2\u6388\u6743"]},null,8,["modelValue","data"]),[[i,e.menu.loading]])]),_:1}),be,o(r,{class:"btns"},{default:u(()=>[o(a,{size:"mini",type:"primary",disabled:e.role.state==0,onClick:e.saveData},{default:u(()=>[Ee,De]),_:1},8,["disabled","onClick"])]),_:1})])),[[i,e.loading]])}var ve=A(ge,[["render",Fe],["__scopeId","data-v-7247ff70"]]);const Be=$({name:"RoleNew",emits:["success"],setup(e,{emit:t}){const n={roleName:[{required:!0,message:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",trigger:"blur"},{min:2,max:10,message:"\u957F\u5EA6\u5728 2 \u5230 10 \u4E2A\u5B57\u7B26",trigger:"blur"}]},C="/role/add",g=ae(),m=w({form:{roleName:"",remark:""},loading:!1});return D({submitForm:()=>{g.value.validate(_=>_?(t("success",D({},m.form)),!0):(console.log("error submit!!"),!1))},rules:n,formRef:g,url:C},N(m))}}),ke={class:"new"},ye=h("i",{class:"fa fa-plus"},null,-1),Ae=E(" \u65B0\u589E ");function $e(e,t,n,C,g,m){const c=l("el-input"),_=l("el-form-item"),p=l("el-button"),d=l("el-row"),a=l("el-form"),r=S("loading");return B((b(),V("div",ke,[o(a,{ref:"formRef",model:e.form,rules:e.rules,"label-position":"right","label-width":"100px"},{default:u(()=>[o(_,{label:"\u89D2\u8272\u540D\u79F0",prop:"roleName"},{default:u(()=>[o(c,{modelValue:e.form.roleName,"onUpdate:modelValue":t[0]||(t[0]=i=>e.form.roleName=i),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(_,{label:"\u5907\u6CE8"},{default:u(()=>[o(c,{modelValue:e.form.remark,"onUpdate:modelValue":t[1]||(t[1]=i=>e.form.remark=i),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1}),o(d,{class:"btn-container"},{default:u(()=>[o(p,{size:"mini",type:"primary",onClick:t[2]||(t[2]=i=>e.submitForm())},{default:u(()=>[ye,Ae]),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[r,e.loading]])}var we=A(Be,[["render",$e]]);const Ne=e=>{console.log(e),_e.confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u8BE5\u6570\u636E, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{T({type:"success",message:"\u5220\u9664\u6210\u529F"})}).catch(()=>{T({type:"info",message:"\u5DF2\u53D6\u6D88\u5220\u9664"})})},Se=$({name:"RoleManage",components:{RoleEdit:ve,RoleNew:we,Edit:re,Minus:ie,Plus:ce,Refresh:de},setup(){const e=w({url:{c:"/role/add",r:"/role/list",u:"/role/update",d:"/role/delete"},param:{limit:10,page:1},data:[{roleName:"\u8D85\u7EA7\u7BA1\u7406\u5458",remark:"\u62E5\u6709\u5220\u9664\u548C\u521B\u5EFA\u7B49\u64CD\u4F5C\u7684\u6743\u9650",state:0},{roleName:"\u7BA1\u7406\u5458",remark:"\u62E5\u6709\u521B\u5EFA\u548C\u6743\u9650\u5206\u914D\u7684\u6743\u9650",state:0},{roleName:"\u6E38\u5BA2",remark:"\u53EA\u62E5\u6709\u64CD\u4F5C\u90E8\u5206\u83DC\u5355\u7684\u6743\u9650",state:1}],loading:!1,is_search:!1,add_visible:!1,edit_visible:!1,detail_visible:!1,posted:{role:{roleName:"",state:1}}}),t=v(()=>e.data.length),n=()=>{},C=a=>{e.param.limit=a},g=()=>{e.add_visible=!0},m=a=>{console.log(a);const r={roleName:a.roleName,remark:a.remark,state:1};e.data.push(r),e.add_visible=!1},c=()=>{e.edit_visible=!1},_=()=>{e.is_search=!1},p=(a,r)=>{console.log("row",r),e.posted.role=r,e.edit_visible=!0},d=(a,r)=>{console.log(a,r),Ne(a)};return y(D({},N(e)),{total:t,onCurrentChange:n,onSizeChange:C,onCreate:g,onCreateSuccess:m,onEditSuccess:c,onRefresh:_,onEdit:p,onDelete:d})}}),Ve=E(" \u65B0\u589E"),ze=E(" \u5237\u65B0"),Re=h("br",null,null,-1),Me=h("i",{class:"ic ic-lock"},null,-1),Pe=E(" \u9501\u5B9A"),Te=E("\u6B63\u5E38"),Ue=E("\u672A\u77E5"),je={class:"pagination"};function qe(e,t,n,C,g,m){const c=l("el-alert"),_=l("plus"),p=l("el-icon"),d=l("el-button"),a=l("refresh"),r=l("el-col"),i=l("el-row"),s=l("el-table-column"),k=l("el-tag"),j=l("edit"),z=l("el-tooltip"),q=l("minus"),I=l("el-table"),O=l("el-pagination"),L=l("el-card"),H=l("role-edit"),R=l("el-dialog"),G=l("role-new"),J=S("loading");return b(),V("div",null,[o(c,{title:"Tips:\u70B9\u51FB\u3010\u65B0\u589E\u3011\u6309\u94AE\u8FDB\u884C\u65B0\u589E\u89D2\u8272\uFF1B\u70B9\u51FB\u3010\u7F16\u8F91\u3011\u6309\u94AE\uFF0C\u8FDB\u884C\u4E0D\u540C\u89D2\u8272\u7684\u83DC\u5355\u6388\u6743\u64CD\u4F5C\uFF01",type:"warning"}),o(c,{title:"Tips:\u6743\u9650\u63A7\u5236\u4F53\u9A8C\uFF1A\u3010\u7BA1\u7406\u5458\u8D26\u53F7\u4E3A\uFF1Aadmin@outlook.com\u3011\u3001\u3010\u8D85\u7EA7\u7BA1\u7406\u5458\u8D26\u53F7\u4E3A\uFF1Asuper@outlook.com\u3011",type:"info"}),o(L,{class:"card-ctrl"},{default:u(()=>[o(i,null,{default:u(()=>[o(r,{span:8,style:{"text-align":"left"}},{default:u(()=>[o(d,{type:"primary",size:"small",onClick:e.onCreate},{default:u(()=>[o(p,null,{default:u(()=>[o(_)]),_:1}),Ve]),_:1},8,["onClick"]),o(d,{type:"success",size:"small",onClick:e.onRefresh},{default:u(()=>[o(p,null,{default:u(()=>[o(a)]),_:1}),ze]),_:1},8,["onClick"])]),_:1})]),_:1}),Re,B((b(),F(I,{data:e.data,stripe:"",class:"table"},{default:u(()=>[o(s,{prop:"roleName",label:"\u89D2\u8272\u540D\u79F0",align:"center"}),o(s,{prop:"state",label:"\u89D2\u8272\u72B6\u6001",align:"center"},{default:u(f=>[f.row.state==0?(b(),F(k,{key:0,size:"mini",type:"info"},{default:u(()=>[Me,Pe]),_:1})):f.row.state==1?(b(),F(k,{key:1,size:"mini",type:"success"},{default:u(()=>[Te]),_:1})):(b(),F(k,{key:2,size:"mini",type:"danger"},{default:u(()=>[Ue]),_:1}))]),_:1}),o(s,{prop:"remark",label:"\u5907\u6CE8",align:"center"}),o(s,{label:"\u64CD\u4F5C",align:"center"},{default:u(f=>[o(z,{class:"item",effect:"dark",content:"\u83DC\u5355\u6388\u6743",placement:"bottom"},{default:u(()=>[o(d,{circle:"",plain:"",type:"primary",size:"small",onClick:K=>e.onEdit(f.$index,f.row)},{default:u(()=>[o(p,null,{default:u(()=>[o(j)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),f.row.state!=0?(b(),F(z,{key:0,class:"item",effect:"dark",content:"\u5220\u9664",placement:"bottom"},{default:u(()=>[o(d,{circle:"",plain:"",type:"danger",size:"small",onClick:K=>e.onDelete(f.$index,f.row)},{default:u(()=>[o(p,null,{default:u(()=>[o(q)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):me("",!0)]),_:1})]),_:1},8,["data"])),[[J,e.loading]]),h("div",je,[o(O,{"current-page":e.param.page,"page-size":e.param.limit,layout:"sizes,prev,pager,next,total","page-sizes":[5,10,20],total:e.total,background:"",onCurrentChange:e.onCurrentChange,onSizeChange:e.onSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])]),_:1}),o(R,{modelValue:e.edit_visible,"onUpdate:modelValue":t[0]||(t[0]=f=>e.edit_visible=f),center:"",title:e.posted.role.roleName},{default:u(()=>[o(H,{"current-role":e.posted,onSuccess:e.onEditSuccess},null,8,["current-role","onSuccess"])]),_:1},8,["modelValue","title"]),o(R,{modelValue:e.add_visible,"onUpdate:modelValue":t[1]||(t[1]=f=>e.add_visible=f),title:"\u65B0\u589E\u89D2\u8272"},{default:u(()=>[o(G,{onSuccess:e.onCreateSuccess},null,8,["onSuccess"])]),_:1},8,["modelValue"])])}var He=A(Se,[["render",qe]]);export{He as default};
