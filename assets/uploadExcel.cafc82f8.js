var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{X as o}from"./xlsx.b0eb9faf.js";import{_ as r}from"./index.14b06000.js";import{d as n,r as d,y as i,A as c,j as p,a6 as u,e as f,c as v,g as b,s as m,m as h,G as y,k as x,F as g,t as _,E as w,I as j,p as D,f as O}from"./vendor.c9ee9e3e.js";const P=e=>new Promise((a=>{const l=new FileReader;l.onload=e=>{var l;const t=null==(l=null==e?void 0:e.target)?void 0:l.result,s=o.read(t,{type:"array"}),r=s.SheetNames[0],n=s.Sheets[r],d=o.utils.sheet_to_json(n),i=(e=>{const a=[],l=o.utils.decode_range(e["!ref"]),t=l.s.r;for(let s=l.s.c;s<=l.e.c;++s){const l=e[o.utils.encode_cell({c:s,r:t})];let r=`void${s}`;l&&l.t&&(r=o.utils.format_cell(l)),a.push(r)}return a})(n);a({header:i,excelData:d})},l.readAsArrayBuffer(e)}));const k=n({components:{},setup(){const e=d(!1),o=d(),r=d(".xls,.xlsx"),n=i({excelData:[],header:[],fileList:[],loading:!1}),p=async e=>{const{excelData:a,header:l}=await P(e);n.excelData=a,n.header=l,n.loading=!1};return((e,o)=>{for(var r in o||(o={}))l.call(o,r)&&s(e,r,o[r]);if(a)for(var r of a(o))t.call(o,r)&&s(e,r,o[r]);return e})({uploadRef:o,accept:r,disabled:e,handlePreview:e=>{n.loading=!0,p(e.raw)},handleRemove:(e,a)=>{console.log(e,a)},handleFileData:e=>{p(e)},handleSubmitUpload:()=>{o.value.submit(),w.ElMessage({type:"success",message:"上传成功"})}},c(n))}}),R=e=>(D("data-v-b8451a02"),e=e(),O(),e),S={class:"upload-container"},A={class:"info"},E=j("上传excel"),F=R((()=>b("span",{style:{"text-align":"left"}},"excel上传预览场景。",-1))),I={class:"grid-content bg-purple-dark"},C={style:{"text-align":"left"}},L=R((()=>b("span",null,"上传excel文件并预览场景",-1))),U={class:"section"},z=R((()=>b("i",{class:"el-icon-upload"},null,-1))),B=R((()=>b("div",{class:"el-upload__text"},[j("将文件拖到此处，或"),b("em",null,"点击上传")],-1))),G=R((()=>b("div",{class:"el-upload__tip"},"点击文件进行预览",-1))),M={class:"preview-table"},N=j("确认上传");var X=r(k,[["render",function(e,a,l,t,s,o){const r=p("el-divider"),n=p("el-upload"),d=p("el-table-column"),i=p("el-table"),c=p("el-button"),w=p("el-card"),j=p("el-col"),D=p("el-row"),O=u("loading");return f(),v("div",S,[b("div",A,[m(r,{"content-position":"left"},{default:h((()=>[E])),_:1}),F]),b("div",null,[m(D,null,{default:h((()=>[m(j,{offset:1,span:22},{default:h((()=>[b("div",I,[m(w,{class:"box-card"},{default:h((()=>[b("div",C,[L,m(r)]),b("div",U,[m(n,{ref:"uploadRef",style:{width:"100%"},accept:e.accept,drag:"",action:"https://jsonplaceholder.typicode.com/posts/","on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!1},{tip:h((()=>[G])),default:h((()=>[z,B])),_:1},8,["accept","on-preview","on-remove","file-list"]),b("div",M,[y((f(),x(i,{data:e.excelData,border:"",style:{width:"100%"}},{default:h((()=>[(f(!0),v(g,null,_(e.header,(e=>(f(),x(d,{key:e,prop:e,label:e,width:"180"},null,8,["prop","label"])))),128))])),_:1},8,["data"])),[[O,e.loading]])]),m(c,{style:{"margin-left":"10px"},size:"small",type:"success",onClick:e.handleSubmitUpload},{default:h((()=>[N])),_:1},8,["onClick"])])])),_:1})])])),_:1})])),_:1})])])}],["__scopeId","data-v-b8451a02"]]);export{X as default};
