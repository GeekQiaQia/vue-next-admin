var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,d=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,n=(e,a)=>{for(var t in a||(a={}))o.call(a,t)&&d(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&d(e,t,a[t]);return e},u=(e,l)=>a(e,t(l));import{_ as r}from"./lodash.0c8485ed.js";import{r as c}from"./index.fe60d648.js";import{y as i,d as p,k as m,e as _,c as k,s as f,q as v,m as b,v as y,I as j,g as w,r as g,b as V,aQ as I,F as T,t as h,p as x,f as L,A as P,w as U,i as S,n as M,bm as C}from"./vendor.67cd59db.js";import{S as O}from"./sortable.esm.d55fbdd0.js";const N={class:"task-table"},E={key:1},z={key:1},A={key:1},D=j("保存"),q=j("编辑"),$=j("删除"),B={class:"task-table__add"},F=j("+ 新增任务");var Q=p({props:{data:null,status:null},emits:["updateTask","modifyTaskEdit","addProjectTask","deleteProjectTask"],setup(e,{emit:a}){function t(){a("addProjectTask")}return(l,o)=>{const s=m("el-input"),d=m("el-table-column"),r=m("el-option"),c=m("el-select"),i=m("el-tag"),p=m("el-button"),g=m("el-popconfirm"),V=m("el-table");return _(),k("div",N,[f(V,{data:e.data,style:{width:"100%"}},{default:v((()=>[f(d,{prop:"taskName",label:"任务名称"},{default:v((e=>[e.row.edit?(_(),b(s,{key:0,modelValue:e.row.taskName,"onUpdate:modelValue":a=>e.row.taskName=a},null,8,["modelValue","onUpdate:modelValue"])):(_(),k("span",E,y(e.row.taskName),1))])),_:1}),f(d,{prop:"developTime",label:"开发工时"},{default:v((e=>[e.row.edit?(_(),b(s,{key:0,modelValue:e.row.developTime,"onUpdate:modelValue":a=>e.row.developTime=a},null,8,["modelValue","onUpdate:modelValue"])):(_(),k("span",z,y(e.row.developTime),1))])),_:1}),f(d,{prop:"developMember",label:"开发人"},{default:v((e=>[e.row.edit?(_(),b(s,{key:0,modelValue:e.row.developMember,"onUpdate:modelValue":a=>e.row.developMember=a},null,8,["modelValue","onUpdate:modelValue"])):(_(),k("span",A,y(e.row.developMember),1))])),_:1}),f(d,{prop:"taskStatus",label:"任务状态"},{default:v((a=>{var t;return[a.row.edit?(_(),b(c,{key:0,modelValue:a.row.taskStatus,"onUpdate:modelValue":e=>a.row.taskStatus=e,placeholder:"选择任务状态"},{default:v((()=>[f(r,{label:"准备阶段",value:"preparation"}),f(r,{label:"开发中",value:"development"}),f(r,{label:"开发完成",value:"completed"}),f(r,{label:"测试阶段",value:"test"}),f(r,{label:"待发布",value:"released"})])),_:2},1032,["modelValue","onUpdate:modelValue"])):(_(),b(i,{key:1,type:null==(t=e.status.get(`${a.row.taskStatus}`))?void 0:t.type},{default:v((()=>{var t;return[j(y(null==(t=e.status.get(`${a.row.taskStatus}`))?void 0:t.text),1)]})),_:2},1032,["type"]))]})),_:1}),f(d,{label:"操作",width:"200"},{default:v((e=>[e.row.edit?(_(),b(p,{key:0,size:"mini",type:"success",icon:"el-icon-check",onClick:t=>function(e){console.log(e);const t=e.taskId;a("updateTask",t,u(n({},e),{edit:!1}))}(e.row)},{default:v((()=>[D])),_:2},1032,["onClick"])):(_(),b(p,{key:1,size:"mini",icon:"el-icon-edit",onClick:t=>function(e){console.log(e);const t=e.taskId;a("modifyTaskEdit",t,!0)}(e.row)},{default:v((()=>[q])),_:2},1032,["onClick"])),f(g,{"confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定删除该条记录吗？",onConfirm:t=>function(e){const t=e.taskId;a("deleteProjectTask",t)}(e.row)},{reference:v((()=>[f(p,{size:"mini",icon:"el-icon-delete",type:"danger"},{default:v((()=>[$])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),w("div",B,[f(p,{onClick:t},{default:v((()=>[F])),_:1})])])}}});Q.__scopeId="data-v-2f66a94a";const G=e=>(x("data-v-5f454e73"),e=e(),L(),e),H={class:"task-column"},J=G((()=>w("div",{class:"task-column__head"},[w("div",{class:"task-column__num"},[w("div",{class:"task-column__num-count"},"3")]),w("div",{class:"task-column__type"}," 准备阶段 "),w("div",{class:"task-column__add"}," + ")],-1))),K=G((()=>w("div",{class:"task-column__head"},[w("div",{class:"task-column__num"},[w("div",{class:"task-column__num-count"},"3")]),w("div",{class:"task-column__type"}," 开发中 "),w("div",{class:"task-column__add"}," + ")],-1)));var R=p({setup(e,{emit:a}){const t=g({}),l=g({});let o;const s=g([{id:"1",task:"task1：可拖拽组件开发"},{id:"2",task:"task2：监控页面开发"},{id:"3",task:"task3：低代码平台开发"}]);return V((()=>{o=new O(t.value,{group:"name",animation:150,onAdd:e=>{console.log(e.from.dataset.item),console.log(e.to.dataset.item)}}),new O(l.value,{group:"name",animation:150,onAdd:e=>{console.log(e.from.dataset.item),console.log(e.to.dataset.item)}})})),I((()=>{o.destroy()})),(e,a)=>{const o=m("el-input"),d=m("el-card");return _(),k("div",H,[f(d,{class:"task-column__item"},{default:v((()=>[J,w("div",{ref:(e,a)=>{a.column=e,t.value=e},"data-item":"ready"},[(_(!0),k(T,null,h(s.value,(e=>(_(),b(o,{class:"task-column__content",modelValue:e.task,"onUpdate:modelValue":a=>e.task=a,readonly:"",placeholder:"请输入内容"},null,8,["modelValue","onUpdate:modelValue"])))),256))],512)])),_:1}),f(d,{class:"task-column__item"},{default:v((()=>[K,w("div",{ref:(e,a)=>{a.column1=e,l.value=e},"data-item":"develop"},[(_(!0),k(T,null,h(s.value,(e=>(_(),b(o,{class:"task-column__content",modelValue:e.task,"onUpdate:modelValue":a=>e.task=a,readonly:"",placeholder:"请输入内容"},null,8,["modelValue","onUpdate:modelValue"])))),256))],512)])),_:1})])}}});R.__scopeId="data-v-5f454e73";const W=e=>(x("data-v-7380d9b7"),e=e(),L(),e),X={class:"board"},Y={class:"board__info"},Z=j("项目看板"),ee=W((()=>w("span",null,"项目看板主要应用场景：项目的任务管理，任务进度管理等。",-1))),ae={class:"board__project"},te=W((()=>w("div",{class:"board__project-title"},"项目概览",-1))),le={class:"board__project-list"},oe=["onClick"],se={class:"board__detail"},de=W((()=>w("div",{class:"board__detail-title"},"项目详情",-1))),ne={key:0,class:"board__detail-empty"},ue={key:1,class:"board__detail-content"},re={class:"board__detail-head"},ce=W((()=>w("span",{class:"board__detail-name"},"项目名称",-1))),ie=W((()=>w("span",{class:"board__detail-name"},"负责人",-1))),pe=W((()=>w("span",{class:"board__detail-name"},"开发工时",-1))),me=W((()=>w("span",{class:"board__detail-name"},"项目状态",-1))),_e=W((()=>w("span",{class:"board__detail-name"},"任务总数",-1))),ke=W((()=>w("span",{class:"board__detail-name"},"任务进度",-1))),fe=j("： "),ve={class:"board__detail-search"},be=j("查询"),ye={class:"board__detail-table"};var je=p({setup(e){const a=i({taskStatus:null,developMember:""}),t=new Map([["preparation",{text:"准备阶段",type:"info"}],["development",{text:"开发中",type:""}],["completed",{text:"开发完成",type:"success"}],["test",{text:"测试阶段",type:"danger"}],["released",{text:"待发布",type:"warning"}]]),l=g([]),o=g("column"),{store:s,updatedProjectInfo:d,addProjectTask:p,deleteTask:V,modifyTaskEdit:I}=(()=>{const e=i({data:[],target:{}});return c({url:"/api/project/list",method:"get",json:!0}).then((a=>{0===a.status&&(e.data=a.data,e.target=a.data[0])})),{store:e,updatedProjectInfo:function(a,t,l){const o=r.findIndex(e.data,["projectId",a]),s=e.data[o].taskList,d=r.map(s,((e,a)=>e.taskId===t?l:e));e.data[o].taskList=d},addProjectTask:function(a,t){const l=r.findIndex(e.data,["projectId",a]),o=e.data[l].taskList;e.data[l].taskList=r.concat(o,t,[])},deleteTask:function(a,t){const l=r.findIndex(e.data,["projectId",a]),o=e.data[l].taskList,s=r.map(o,((e,a)=>{if(e.taskId!==t)return e})).filter((e=>e));e.data[l].taskList=s},getProjectDetail:function(a){return r.find(e.data,(e=>e.projectId===a))},modifyTaskEdit:function(a,t,l=!1){const o=r.findIndex(e.data,["projectId",a]),s=e.data[o].taskList,d=r.map(s,((e,a)=>e.taskId===t?u(n({},e),{edit:l}):e));e.data[o].taskList=d}}})(),{data:x,target:L}=P(s);U((()=>L.value),(e=>{l.value=e.taskList}),{deep:!0});const O=S((()=>{const e=r.countBy(L.value.taskList,(e=>e.taskStatus));return r.map(Object.entries(e),(([e,a])=>{const l=t.get(e);return u(n({},l),{count:a})}))})),N=S((()=>{const e=r.map(L.value.taskList,(e=>e.developMember)).filter((e=>e));return r.uniq(e)}));function E(){console.log("search!",a);const e=a.taskStatus,t=a.developMember;if(e&&t){const a=r.map(L.value.taskList,(a=>{if(a.developMember===t&&a.taskStatus===e)return a})).filter((e=>e));l.value=a}else if(e){const a=r.map(L.value.taskList,(a=>{if(a.taskStatus===e)return a})).filter((e=>e));l.value=a}else if(t){const e=r.map(L.value.taskList,(e=>{if(e.developMember===t)return e})).filter((e=>e));l.value=e}else l.value=L.value.taskList}function z(e,a){const t=L.value.projectId;I(t,e,a)}function A(e,a){const t=L.value.projectId;d(t,e,a)}function D(){const e=L.value.projectId,a={taskName:"",developTime:"",developMember:"",taskStatus:"preparation",edit:!0,taskId:Date.now()};p(e,a)}function q(e){const a=L.value.projectId;V(a,e)}function $(e){switch(e.paneName){case"table":console.log("表格形式");break;case"column":console.log("列表形式")}}return(e,s)=>{const d=m("el-divider"),n=m("el-avatar"),u=m("el-col"),r=m("el-row"),c=m("el-card"),i=m("el-tag"),p=m("el-option"),g=m("el-select"),V=m("el-form-item"),I=m("el-button"),P=m("el-form"),U=m("el-tab-pane"),S=m("el-tabs");return _(),k("div",X,[w("div",Y,[f(d,{"content-position":"left"},{default:v((()=>[Z])),_:1}),ee]),w("div",ae,[te,w("div",le,[(_(!0),k(T,null,h(C(x),((e,a)=>(_(),k("div",{key:a,class:M(["board__project-item",{"board__project-item--active":C(L).projectId===e.projectId}]),onClick:a=>{return t=e,void(L.value=t);var t}},[f(c,null,{default:v((()=>[f(r,null,{default:v((()=>[f(u,{span:5},{default:v((()=>[f(n,{class:"board__project-avatar",size:90},{default:v((()=>[j(y(e.projectName.substr(0,1)),1)])),_:2},1024)])),_:2},1024),f(u,{span:18,style:{"margin-left":"6px",color:"#7a848d"}},{default:v((()=>[w("p",null,"项目名称："+y(e.projectName),1),w("p",null,"总负责人："+y(e.principal),1),w("p",null,"开发耗时："+y(e.timeConsuming),1),w("p",null,"项目状态: "+y(e.status),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)],10,oe)))),128))])]),w("div",se,[de,f(c,{class:"board__detail-wrap"},{default:v((()=>[C(L).projectId?(_(),k("div",ue,[w("div",re,[f(r,null,{default:v((()=>[f(u,{span:5},{default:v((()=>[ce,j("："+y(C(L).projectName),1)])),_:1}),f(u,{span:5},{default:v((()=>[ie,j("："+y(C(L).principal),1)])),_:1}),f(u,{span:5},{default:v((()=>[pe,j("："+y(C(L).timeConsuming),1)])),_:1}),f(u,{span:5},{default:v((()=>[me,j("："+y(C(L).status),1)])),_:1})])),_:1}),f(r,{class:"board__detail-task"},{default:v((()=>[f(u,{span:5},{default:v((()=>[_e,j("："+y(C(L).taskList.length),1)])),_:1}),f(u,{span:18},{default:v((()=>[ke,fe,(_(!0),k(T,null,h(C(O),((e,a)=>(_(),b(i,{key:a,class:"board__detail-tag",type:e.type},{default:v((()=>[j(y(e.text)+": "+y(e.count),1)])),_:2},1032,["type"])))),128))])),_:1})])),_:1})]),f(S,{modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=e=>o.value=e),type:"card",onTabClick:$},{default:v((()=>[f(U,{label:"表格模式",name:"table"},{default:v((()=>[w("div",ve,[f(P,{inline:!0,model:C(a)},{default:v((()=>[f(V,{label:"开发人"},{default:v((()=>[f(g,{clearable:"",modelValue:C(a).developMember,"onUpdate:modelValue":s[0]||(s[0]=e=>C(a).developMember=e),placeholder:"选择任务开发者"},{default:v((()=>[(_(!0),k(T,null,h(C(N),((e,a)=>(_(),b(p,{key:a,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(V,{label:"任务状态"},{default:v((()=>[f(g,{clearable:"",modelValue:C(a).taskStatus,"onUpdate:modelValue":s[1]||(s[1]=e=>C(a).taskStatus=e),placeholder:"选择任务状态"},{default:v((()=>[f(p,{label:"准备阶段",value:"preparation"}),f(p,{label:"开发中",value:"development"}),f(p,{label:"开发完成",value:"completed"}),f(p,{label:"测试阶段",value:"test"}),f(p,{label:"待发布",value:"released"})])),_:1},8,["modelValue"])])),_:1}),f(V,null,{default:v((()=>[f(I,{type:"primary",onClick:E},{default:v((()=>[be])),_:1})])),_:1})])),_:1},8,["model"])]),w("div",ye,[f(Q,{data:l.value,status:C(t),onUpdateTask:A,onModifyTaskEdit:z,onAddProjectTask:D,onDeleteProjectTask:q},null,8,["data","status"])])])),_:1}),f(U,{label:"列表模式",name:"column"},{default:v((()=>[f(R)])),_:1})])),_:1},8,["modelValue"])])):(_(),k("div",ne,"请选择项目，查看项目详情！！！"))])),_:1})])])}}});je.__scopeId="data-v-7380d9b7";export{je as default};
