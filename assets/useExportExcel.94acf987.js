var e=Object.defineProperty,t=(t,o,r)=>(((t,o,r)=>{o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r})(t,"symbol"!=typeof o?o+"":o,r),r);import{F as o}from"./file-saver.dc65ec7b.js";import{X as r}from"./xlsx.56335676.js";import"./element-plus.c35c14b5.js";import"./@vue.9dcf4325.js";import"./lodash.a533b6d4.js";import"./resize-observer-polyfill.af5c5caa.js";import"./@popperjs.b42a2641.js";import"./dayjs.80b0a338.js";import"./mitt.06a3009f.js";import"./async-validator.9224cb80.js";import"./normalize-wheel.1d574cd1.js";import"./vue.1f809ab3.js";function l(e,t){t&&(e=Number(e)+1462);return(Date.parse(String(e))-Date.parse(String(new Date(Date.UTC(1899,11,30)))))/864e5}function n(e,t){const o={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(let s=0;s!==e.length;++s)for(let t=0;t!==e[s].length;++t){n.s.r>s&&(n.s.r=s),n.s.c>t&&(n.s.c=t),n.e.r<s&&(n.e.r=s),n.e.c<t&&(n.e.c=t);const c={v:e[s][t]};if(null!==c.v){const e=r.utils.encode_cell({c:t,r:s});if("number"==typeof c.v)c.t="n";else if("boolean"==typeof c.v)c.t="b";else if(c.v instanceof Date){c.t="n";const e=r.SSF.parse_date_code(14);c.z=e,c.v=l(c.v)}else c.t="s";o[e]=c}}return n.s.c<1e7&&(o["!ref"]=r.utils.encode_range(n)),o}class s{constructor(e=[],o={}){t(this,"SheetNames"),t(this,"Sheets"),this.SheetNames=e,this.Sheets=o}}function c(e){const t=new ArrayBuffer(e.length),o=new Uint8Array(t);for(let r=0;r!==e.length;++r)o[r]=255&e.charCodeAt(r);return t}function a(e){const t=function(e){console.log(e);const t=[],o=null==e?void 0:e.querySelectorAll("tr"),r=[];for(let l=0;l<o.length;++l){const e=[],n=o[l].querySelectorAll("td");for(let t=0;t<n.length;++t){const o=n[t];let s=o.getAttribute("colspan"),c=o.getAttribute("rowspan"),a=o.innerText;if("number"==typeof a&&a===Number(a)&&(a=Number(a)),r.forEach((t=>{if(l>=t.s.r&&l<=t.e.r&&e.length>=t.s.c&&e.length<=t.e.c)for(let o=0;o<=t.e.c-t.s.c;++o)e.push(null)})),(c||s)&&(c=c||1,s=s||1,r.push({s:{r:l,c:e.length},e:{r:l+c-1,c:e.length+s-1}})),e.push(""!==a?a:null),s)for(let t=0;t<s-1;++t)e.push(null)}t.push(e)}return[t,r]}(document.getElementById(e)),l=t[1],a=t[0],i="SheetJS",u=new s,h=n(a);h["!merges"]=l,u.SheetNames.push(i),u.Sheets.SheetJS=h;const p=r.write(u,{bookType:"xlsx",bookSST:!1,type:"binary"});o.exports.saveAs(new Blob([c(p)],{type:"application/octet-stream"}),"test.xlsx")}function i(e){var t,l,a,i,u;const h=null!=(t=null==e?void 0:e.filename)?t:"defaultExcel",p=null!=(l=null==e?void 0:e.bookType)?l:"xlsx",f=null!=(a=null==e?void 0:e.multiHeader)?a:[],m=null!=(i=null==e?void 0:e.merges)?i:[],g=null==(u=e.autoWidth)||u,b=[...e.data];b.unshift(e.header);for(let o=f.length-1;o>-1;o--)b.unshift(f[o]);const d="SheetJS",S=new s,v=n(b);if(m.length>0&&(v["!merges"]||(v["!merges"]=[]),m.forEach((e=>{v["!merges"].push(r.utils.decode_range(e))}))),g){const e=b.map((e=>e.map((e=>null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length})))),t=e[0];for(let o=1;o<e.length;o++)for(let r=0;r<e[o].length;r++)t[r].wch<e[o][r].wch&&(t[r].wch=e[o][r].wch);v["!cols"]=t}S.SheetNames.push(d),S.Sheets.SheetJS=v;const y=r.write(S,{bookType:p,bookSST:!1,type:"binary"});o.exports.saveAs(new Blob([c(y)],{type:"application/octet-stream"}),`${h}.${p}`)}var u={exportTableToExcel:a,exportJsonToExcel:i};export{u as default,i as exportJsonToExcel,a as exportTableToExcel};
