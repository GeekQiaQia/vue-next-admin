var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,s=(e,l)=>{for(var a in l||(l={}))o.call(l,a)&&r(e,a,l[a]);if(t)for(var a of t(l))n.call(l,a)&&r(e,a,l[a]);return e},i=(e,t)=>l(e,a(t));import{d,B as u,n as c,m,e as p,s as f,p as b,a as g,i as _,aJ as v,y,o as h,c as C,b as k,t as w,w as z,A as N,r as S,D as V,_ as j,E as x}from"./vendor.9109f4bb.js";import{_ as O}from"./message-box.35c2f0f0.js";import{u as R}from"./index.dde68f35.js";var D=d({props:{currentRole:{type:Object,default:()=>({roleName:"",state:1})}},setup(e){const l=u(e,"currentRole"),a=R(),t=c({url:"/role/allow",purl:"/role/permissions",loading:!1,form:{key:"",label:""},menu:{loading:!1,url:"/menu/list",data:[],form:[]}}),o=m((()=>l.value.role)),n=m((()=>a.state.permissionModule.routes)),r=()=>{var e,l;for(const a of n.value)(null==(e=null==a?void 0:a.meta)?void 0:e.hidden)||t.menu.data.push({key:null==a?void 0:a.path,label:null==(l=null==a?void 0:a.meta)?void 0:l.title})};return p((()=>{r()})),i(s({},f(t)),{role:o,fetchMenuData:r,fetchData:()=>{},saveData:()=>{}})}});const E=z();b("data-v-25b36d06");const P={class:"wrapper"},U={class:"card-header"},B=k("br",null,null,-1),M=k("i",{class:"fa fa-check"},null,-1),F=N(" 确认修改 ");g();const I=E(((e,l,a,t,o,n)=>{const r=_("el-form-item"),s=_("el-form"),i=_("el-transfer"),d=_("el-card"),u=_("el-button"),c=_("el-row"),m=v("loading");return y((h(),C("div",P,[k(d,{class:"transfer"},{header:E((()=>[k("span",null,[k("div",U,[k(s,{"label-position":"left",inline:"",class:"info-table"},{default:E((()=>[k(r,{label:"名称"},{default:E((()=>[k("span",null,w(e.role.roleName),1)])),_:1})])),_:1})])])])),default:E((()=>[y(k(i,{modelValue:e.menu.form,"onUpdate:modelValue":l[1]||(l[1]=l=>e.menu.form=l),data:e.menu.data,titles:["菜单","已授权"]},null,8,["modelValue","data"]),[[m,e.menu.loading]])])),_:1}),B,k(c,{class:"btns"},{default:E((()=>[k(u,{size:"mini",type:"primary",disabled:0==e.role.state,onClick:e.saveData},{default:E((()=>[M,F])),_:1},8,["disabled","onClick"])])),_:1})],512)),[[m,e.loading]])}));D.render=I,D.__scopeId="data-v-25b36d06";var T=d({name:"RoleNew",emits:["success"],setup(e,{emit:l}){const a=S(),t=c({form:{roleName:""},loading:!1});return s({submitForm:()=>{a.value.validate((e=>e?(l("success",s({},t.form)),!0):(console.log("error submit!!"),!1)))},rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}]},formRef:a,url:"/role/add"},f(t))}});const $={class:"new"},q=k("i",{class:"fa fa-plus"},null,-1),A=N(" 新增 ");T.render=function(e,l,a,t,o,n){const r=_("el-input"),s=_("el-form-item"),i=_("el-button"),d=_("el-row"),u=_("el-form"),c=v("loading");return y((h(),C("div",$,[k(u,{ref:"formRef",model:e.form,rules:e.rules,"label-position":"right","label-width":"100px"},{default:V((()=>[k(s,{label:"角色名称",prop:"roleName"},{default:V((()=>[k(r,{modelValue:e.form.roleName,"onUpdate:modelValue":l[1]||(l[1]=l=>e.form.roleName=l),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),k(d,{class:"btn-container"},{default:V((()=>[k(i,{size:"mini",type:"primary",onClick:l[2]||(l[2]=l=>e.submitForm())},{default:V((()=>[q,A])),_:1})])),_:1})])),_:1},8,["model","rules"])],512)),[[c,e.loading]])};var J=d({name:"RoleManage",components:{RoleEdit:D,RoleNew:T},setup(){const e=c({url:{c:"/role/add",r:"/role/list",u:"/role/update",d:"/role/delete"},param:{limit:10,page:1},data:[{roleName:"超级管理员",state:1},{roleName:"管理员",state:1}],loading:!1,is_search:!1,add_visible:!1,edit_visible:!1,detail_visible:!1,posted:{role:{roleName:"",state:1}}}),l=m((()=>e.data.length));return i(s({},f(e)),{total:l,onCurrentChange:()=>{},onSizeChange:l=>{e.param.limit=l},onCreate:()=>{e.add_visible=!0},onCreateSuccess:l=>{console.log(l);const a={roleName:l.roleName,state:1};e.data.push(a),e.add_visible=!1},onEditSuccess:()=>{e.edit_visible=!1},onRefresh:()=>{e.is_search=!1},onEdit:(l,a)=>{console.log("row",a),e.posted.role=a,console.log(l,a),e.edit_visible=!0},onDelete:(e,l)=>{console.log(e,l),(e=>{console.log(e),O.confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{j({type:"success",message:"删除成功"})})).catch((()=>{j({type:"info",message:"已取消删除"})}))})(e)}})}});const G=N("新增"),H=N("刷新"),K=k("br",null,null,-1),L=k("i",{class:"ic ic-lock"},null,-1),Q=N(" 锁定"),W=N("正常"),X=N("未知"),Y={class:"pagination"};J.render=function(e,l,a,t,o,n){const r=_("el-button"),s=_("el-col"),i=_("el-row"),d=_("el-table-column"),u=_("el-tag"),c=_("el-tooltip"),m=_("el-table"),p=_("el-pagination"),f=_("el-card"),b=_("role-edit"),g=_("el-dialog"),w=_("role-new"),z=v("loading");return h(),C("div",null,[k(f,{class:"card-ctrl"},{default:V((()=>[k(i,null,{default:V((()=>[k(s,{span:8},{default:V((()=>[k(r,{type:"primary",icon:"el-icon-plus",size:"small",onClick:e.onCreate},{default:V((()=>[G])),_:1},8,["onClick"]),k(r,{type:"success",icon:"el-icon-refresh",size:"small",onClick:e.onRefresh},{default:V((()=>[H])),_:1},8,["onClick"])])),_:1})])),_:1}),K,y(k(m,{data:e.data,stripe:"",class:"table"},{default:V((()=>[k(d,{prop:"roleName",label:"角色名称",align:"center"}),k(d,{prop:"state",label:"角色状态",align:"center"},{default:V((e=>[0===e.row.state?(h(),C(u,{key:0,size:"mini",type:"info"},{default:V((()=>[L,Q])),_:1})):1===e.row.state?(h(),C(u,{key:1,size:"mini",type:"success"},{default:V((()=>[W])),_:1})):(h(),C(u,{key:2,size:"mini",type:"danger"},{default:V((()=>[X])),_:1}))])),_:1}),k(d,{label:"操作",align:"center"},{default:V((l=>[k(c,{class:"item",effect:"dark",content:"菜单授权",placement:"bottom"},{default:V((()=>[k(r,{circle:"",plain:"",type:"primary",icon:"el-icon-edit",size:"small",onClick:a=>e.onEdit(l.$index,l.row)},null,8,["onClick"])])),_:2},1024),k(c,{class:"item",effect:"dark",content:"删除",placement:"bottom"},{default:V((()=>[0!=l.row.state?(h(),C(r,{key:0,circle:"",plain:"",type:"danger",icon:"el-icon-minus",size:"small",onClick:a=>e.onDelete(l.$index,l.row)},null,8,["onClick"])):x("",!0)])),_:2},1024)])),_:1})])),_:1},8,["data"]),[[z,e.loading]]),k("div",Y,[k(p,{"current-page":e.param.page,"page-size":e.param.limit,layout:"sizes,prev,pager,next,total","page-sizes":[5,10,20],total:e.total,background:"",onCurrentChange:e.onCurrentChange,onSizeChange:e.onSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])])),_:1}),k(g,{modelValue:e.edit_visible,"onUpdate:modelValue":l[1]||(l[1]=l=>e.edit_visible=l),center:"",title:e.posted.role.roleName},{default:V((()=>[k(b,{"current-role":e.posted,onSuccess:e.onEditSuccess},null,8,["current-role","onSuccess"])])),_:1},8,["modelValue","title"]),k(g,{modelValue:e.add_visible,"onUpdate:modelValue":l[2]||(l[2]=l=>e.add_visible=l),title:"新增角色"},{default:V((()=>[k(w,{onSuccess:e.onCreateSuccess},null,8,["onSuccess"])])),_:1},8,["modelValue"])])};export default J;
