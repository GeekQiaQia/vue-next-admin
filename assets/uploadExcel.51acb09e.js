var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{E as o}from"./element-plus.c35c14b5.js";import{X as r}from"./xlsx.56335676.js";import{a7 as i,k as n,r as d,v as c,aJ as p,aK as u,aB as f,Z as m,_ as v,a5 as b,b4 as h,b6 as y,M as j,aH as x,X as _,a4 as g,aE as w,aC as D}from"./@vue.9dcf4325.js";import"./lodash.a533b6d4.js";import"./resize-observer-polyfill.af5c5caa.js";import"./@popperjs.b42a2641.js";import"./dayjs.80b0a338.js";import"./mitt.06a3009f.js";import"./async-validator.9224cb80.js";import"./normalize-wheel.1d574cd1.js";import"./vue.1f809ab3.js";const O=e=>new Promise((a=>{const l=new FileReader;l.onload=e=>{var l;const t=null==(l=null==e?void 0:e.target)?void 0:l.result,s=r.read(t,{type:"array"}),o=s.SheetNames[0],i=s.Sheets[o],n=r.utils.sheet_to_json(i),d=(e=>{const a=[],l=r.utils.decode_range(e["!ref"]),t=l.s.r;for(let s=l.s.c;s<=l.e.c;++s){const l=e[r.utils.encode_cell({c:s,r:t})];let o=`void${s}`;l&&l.t&&(o=r.utils.format_cell(l)),a.push(o)}return a})(i);a({header:d,excelData:n})},l.readAsArrayBuffer(e)}));var P=i({components:{},setup(){const e=n(!1),r=n(),i=n(".xls,.xlsx"),p=d({excelData:[],header:[],fileList:[],loading:!1}),u=async e=>{const{excelData:a,header:l}=await O(e);p.excelData=a,p.header=l,p.loading=!1};return((e,o)=>{for(var r in o||(o={}))l.call(o,r)&&s(e,r,o[r]);if(a)for(var r of a(o))t.call(o,r)&&s(e,r,o[r]);return e})({uploadRef:r,accept:i,disabled:e,handlePreview:e=>{p.loading=!0,u(e.raw)},handleRemove:(e,a)=>{console.log(e,a)},handleFileData:e=>{u(e)},handleSubmitUpload:()=>{r.value.submit(),o({type:"success",message:"上传成功"})}},c(p))}});const k=e=>(w("data-v-b8451a02"),e=e(),D(),e),R={class:"upload-container"},S={class:"info"},z=g("上传excel"),C=k((()=>v("span",{style:{"text-align":"left"}},"excel上传预览场景。",-1))),E={class:"grid-content bg-purple-dark"},A={style:{"text-align":"left"}},B=k((()=>v("span",null,"上传excel文件并预览场景",-1))),F={class:"section"},I=k((()=>v("i",{class:"el-icon-upload"},null,-1))),L=k((()=>v("div",{class:"el-upload__text"},[g("将文件拖到此处，或"),v("em",null,"点击上传")],-1))),U=k((()=>v("div",{class:"el-upload__tip"},"点击文件进行预览",-1))),X={class:"preview-table"},H=g("确认上传");P.render=function(e,a,l,t,s,o){const r=p("el-divider"),i=p("el-upload"),n=p("el-table-column"),d=p("el-table"),c=p("el-button"),g=p("el-card"),w=p("el-col"),D=p("el-row"),O=u("loading");return f(),m("div",R,[v("div",S,[b(r,{"content-position":"left"},{default:h((()=>[z])),_:1}),C]),v("div",null,[b(D,null,{default:h((()=>[b(w,{offset:1,span:22},{default:h((()=>[v("div",E,[b(g,{class:"box-card"},{default:h((()=>[v("div",A,[B,b(r)]),v("div",F,[b(i,{ref:"uploadRef",style:{width:"100%"},accept:e.accept,drag:"",action:"https://jsonplaceholder.typicode.com/posts/","on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!1},{tip:h((()=>[U])),default:h((()=>[I,L])),_:1},8,["accept","on-preview","on-remove","file-list"]),v("div",X,[y(b(d,{data:e.excelData,border:"",style:{width:"100%"}},{default:h((()=>[(f(!0),m(j,null,x(e.header,(e=>(f(),_(n,{key:e,prop:e,label:e,width:"180"},null,8,["prop","label"])))),128))])),_:1},8,["data"]),[[O,e.loading]])]),b(c,{style:{"margin-left":"10px"},size:"small",type:"success",onClick:e.handleSubmitUpload},{default:h((()=>[H])),_:1},8,["onClick"])])])),_:1})])])),_:1})])),_:1})])])},P.__scopeId="data-v-b8451a02";export{P as default};
