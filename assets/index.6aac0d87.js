var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,L=(e,s)=>{for(var t in s||(s={}))o.call(s,t)&&l(e,t,s[t]);if(a)for(var t of a(s))r.call(s,t)&&l(e,t,s[t]);return e},u=(e,a)=>s(e,t(a));import{v as M}from"./index.6d49b6f3.js";import{d as i,g as j,u as c,r as n,n as d,s as w,_ as m,p as g,a as p,i as N,o as S,c as D,b as y,E as h,w as x,A as E}from"./vendor.9109f4bb.js";import{r as T}from"./request.0cbc9bd0.js";class C{static postLogin(e){return T({url:"/api/auth/user/login",method:"POST",json:!0,data:e}).then((e=>200===e.status?Promise.resolve(e):Promise.reject(e)))}static postRegister(e){return T({url:"/api/auth/user/register",method:"POST",json:!0,data:e}).then((e=>200===e.status?Promise.resolve(e):Promise.reject(e)))}static postCaptcha(e){return T({url:"/api/auth/email/sendCaptcha",method:"POST",json:!0,data:e}).then((e=>200===e.status||400===e.status?Promise.resolve(e):Promise.reject(e)))}static postForgetPwd(e){return T({url:"/api/auth/email/forgot-password",method:"POST",json:!0,data:e}).then((e=>200===e.status||400===e.status?Promise.resolve(e):Promise.reject(e)))}static postResetPwd(e){return T({url:"/api/auth/user/reset-password",method:"POST",json:!0,data:e}).then((e=>200===e.status||400===e.status?Promise.resolve(e):Promise.reject(e)))}static postAuthPermission(e){return T({url:"/api/auth/permission/routes",method:"POST",json:!0,data:e}).then((e=>(console.log(e),200===e.status?Promise.resolve(e):Promise.reject(e))))}}var z=i({name:"LoginForm",emits:["toResetPwd"],setup(e,{emit:s}){const t=j(),a=c(),o=n(),r=n(),l=d({loginForm:{email:"",password:""},registerForm:{email:"",capcha:null,password:"",checkPass:""},showLogin:!0}),M={password:[{validator:(e,s,t)=>{""===s?t(new Error("请输入密码")):(""!==l.registerForm.checkPass&&r.value.validateField("checkPass"),t())},trigger:"blur"},{min:6,max:10,message:"长度在 6 到 10 个字符",trigger:"blur"}],checkPass:[{validator:(e,s,t)=>{""===s?t(new Error("请再次输入密码")):s!==l.registerForm.password?t(new Error("两次输入密码不一致!")):t()},trigger:"blur"}],email:[{required:!0,message:"请输入注册邮箱",trigger:"change"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],capcha:[{required:!0,message:"请输入验证码",trigger:"blur"}]};return u(L({},w(l)),{loginFormRef:o,registerRef:r,rules:M,submitForm:()=>{o.value.validate((async e=>{var s,o;if(e)try{const{email:e,password:r}=l.loginForm,L={email:e,password:r},u=await C.postLogin(L),M=null!=(o=null==(s=null==u?void 0:u.data)?void 0:s.accessToken)?o:null;if(M)if(sessionStorage.setItem("auth","true"),sessionStorage.setItem("accessToken",M),a.query.redirect){const e=a.query.redirect;t.push({path:e})}else t.push("/");else m({type:"warning",message:"账号或者密码有误"})}catch(r){console.error(r)}return!1}))},handleRegister:()=>{r.value.validate((async e=>{if(e)try{const{email:e,password:s,capcha:t}=l.registerForm,a={email:e,capcha:t,password:s};C.postRegister(a).then((e=>{console.log(e),m({type:"success",message:"模拟注册成功"}),l.showLogin=!0}))}catch(s){console.error(s)}}))},handleGetCaptcha:async()=>{try{const{email:e}=l.registerForm,s={email:e},t=await C.postCaptcha(s);console.log(t),400===t.status?m({type:"warning",message:t.message}):m({type:"success",message:t.message})}catch(e){console.error(e)}},handleForget:()=>{s("toResetPwd")}})}});const I=x();g("data-v-da89d8da");const O={class:"form-container"},f={class:"btn-container"},Y=E("登录"),v={class:"operation"},b=E("获取验证码"),F={class:"btn-container"},P=E("完成注册"),A={class:"go-login"},Q=E("已有账号"),k=y("em",null,"去登陆",-1);p();const V=I(((e,s,t,a,o,r)=>{const l=N("el-input"),L=N("el-form-item"),u=N("el-button"),M=N("el-form");return S(),D("div",O,[e.showLogin?(S(),D(M,{key:0,ref:"loginFormRef",model:e.loginForm,"status-icon":"","hide-required-asterisk":!0,rules:e.rules,"label-width":"100px",class:"login-form"},{default:I((()=>[y(L,{label:"账号",prop:"email"},{default:I((()=>[y(l,{modelValue:e.loginForm.email,"onUpdate:modelValue":s[1]||(s[1]=s=>e.loginForm.email=s),autocomplete:"off",placeholder:"请输入登录邮箱(admin@outlook.com)"},null,8,["modelValue"])])),_:1}),y(L,{label:"密码",prop:"password"},{default:I((()=>[y(l,{modelValue:e.loginForm.password,"onUpdate:modelValue":s[2]||(s[2]=s=>e.loginForm.password=s),type:"password",autocomplete:"off",placeholder:"请输入密码(123456)"},null,8,["modelValue"])])),_:1}),y(L,null,{default:I((()=>[y("div",f,[y(u,{type:"primary",style:{width:"100%"},onClick:s[3]||(s[3]=s=>e.submitForm())},{default:I((()=>[Y])),_:1})]),y("div",v,[y("span",{class:"free-register",onClick:s[4]||(s[4]=s=>e.showLogin=!e.showLogin)},"免费注册"),y("span",{class:"forget-password",onClick:s[5]||(s[5]=(...s)=>e.handleForget&&e.handleForget(...s))},"忘记密码")])])),_:1})])),_:1},8,["model","rules"])):h("",!0),e.showLogin?h("",!0):(S(),D(M,{key:1,ref:"registerRef",model:e.registerForm,"status-icon":"","hide-required-asterisk":!0,rules:e.rules,"label-width":"100px",class:"login-form"},{default:I((()=>[y(L,{label:"邮箱",prop:"email"},{default:I((()=>[y(l,{modelValue:e.registerForm.email,"onUpdate:modelValue":s[6]||(s[6]=s=>e.registerForm.email=s),autocomplete:"off",placeholder:"请输入注册邮箱"},{append:I((()=>[y(u,{onClick:e.handleGetCaptcha},{default:I((()=>[b])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])),_:1}),y(L,{label:"验证码",prop:"capcha"},{default:I((()=>[y(l,{modelValue:e.registerForm.capcha,"onUpdate:modelValue":s[7]||(s[7]=s=>e.registerForm.capcha=s),modelModifiers:{number:!0},maxlength:"6",autocomplete:"off",placeholder:"请输入验证码"},null,8,["modelValue"])])),_:1}),y(L,{label:"密码",prop:"password"},{default:I((()=>[y(l,{modelValue:e.registerForm.password,"onUpdate:modelValue":s[8]||(s[8]=s=>e.registerForm.password=s),type:"password",autocomplete:"off",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),y(L,{label:"确认密码",prop:"checkPass"},{default:I((()=>[y(l,{modelValue:e.registerForm.checkPass,"onUpdate:modelValue":s[9]||(s[9]=s=>e.registerForm.checkPass=s),type:"password",autocomplete:"off"},null,8,["modelValue"])])),_:1}),y(L,null,{default:I((()=>[y("div",F,[y(u,{type:"primary",style:{width:"100%"},onClick:s[10]||(s[10]=s=>e.handleRegister())},{default:I((()=>[P])),_:1})]),y("div",A,[y("span",{class:"to-login",onClick:s[11]||(s[11]=s=>e.showLogin=!e.showLogin)},[Q,k])])])),_:1})])),_:1},8,["model","rules"]))])}));z.render=V,z.__scopeId="data-v-da89d8da";var U=i({name:"ForgetPassword",props:{showReset:{type:Boolean,default:!1}},emits:["toLogin"],setup(e,{emit:s}){const t=n(),a=d({resetForm:{email:"",capcha:null,password:"",checkPass:""}}),o={password:[{validator:(e,s,o)=>{""===s?o(new Error("请输入密码")):(""!==a.resetForm.checkPass&&t.value.validateField("checkPass"),o())},trigger:"blur"},{min:6,max:10,message:"长度在 6 到 10 个字符",trigger:"blur"}],checkPass:[{validator:(e,s,t)=>{""===s?t(new Error("请再次输入密码")):s!==a.resetForm.password?t(new Error("两次输入密码不一致!")):t()},trigger:"blur"}],email:[{required:!0,message:"请输入注册邮箱",trigger:"change"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],capcha:[{required:!0,message:"请输入验证码",trigger:"blur"}]};return u(L({},w(a)),{rules:o,resetRef:t,handleGetCaptcha:async()=>{try{const{email:e}=a.resetForm,s={email:e},t=await C.postForgetPwd(s);console.log(t),400===t.status?m({type:"warning",message:t.message}):m({type:"success",message:t.message})}catch(e){console.error(e)}},handleToLogin:()=>{s("toLogin")},handleResetPwd:async()=>{t.value.validate((async e=>{if(e)try{const{email:e,password:t,capcha:o}=a.resetForm,r={email:e,password:t,capcha:o},l=await C.postResetPwd(r);console.log(l),400===l.status?(m({type:"warning",message:l.message}),s("toLogin")):m({type:"success",message:l.message})}catch(t){console.error(t)}return!1}))}})}});const G=x();g("data-v-534d1ad4");const W={class:"form-container"},R=E("获取验证码"),_={class:"btn-container"},Z=E("确认重置"),J={class:"go-login"},B=y("em",null,"去登陆",-1);p();const q=G(((e,s,t,a,o,r)=>{const l=N("el-button"),L=N("el-input"),u=N("el-form-item"),M=N("el-form");return S(),D("div",W,[e.showReset?(S(),D(M,{key:0,ref:"resetRef",model:e.resetForm,"status-icon":"","hide-required-asterisk":!0,rules:e.rules,"label-width":"100px",class:"login-form"},{default:G((()=>[y(u,{label:"邮箱",prop:"email"},{default:G((()=>[y(L,{modelValue:e.resetForm.email,"onUpdate:modelValue":s[1]||(s[1]=s=>e.resetForm.email=s),autocomplete:"off",placeholder:"请输入注册邮箱"},{append:G((()=>[y(l,{onClick:e.handleGetCaptcha},{default:G((()=>[R])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])),_:1}),y(u,{label:"验证码",prop:"capcha"},{default:G((()=>[y(L,{modelValue:e.resetForm.capcha,"onUpdate:modelValue":s[2]||(s[2]=s=>e.resetForm.capcha=s),modelModifiers:{number:!0},maxlength:"6",autocomplete:"off",placeholder:"请输入验证码"},null,8,["modelValue"])])),_:1}),y(u,{label:"密码",prop:"password"},{default:G((()=>[y(L,{modelValue:e.resetForm.password,"onUpdate:modelValue":s[3]||(s[3]=s=>e.resetForm.password=s),type:"password",autocomplete:"off",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),y(u,{label:"确认密码",prop:"checkPass"},{default:G((()=>[y(L,{modelValue:e.resetForm.checkPass,"onUpdate:modelValue":s[4]||(s[4]=s=>e.resetForm.checkPass=s),type:"password",autocomplete:"off"},null,8,["modelValue"])])),_:1}),y(u,null,{default:G((()=>[y("div",_,[y(l,{type:"primary",style:{width:"100%"},onClick:s[5]||(s[5]=s=>e.handleResetPwd())},{default:G((()=>[Z])),_:1})]),y("div",J,[y("span",{class:"to-login",onClick:s[6]||(s[6]=(...s)=>e.handleToLogin&&e.handleToLogin(...s))},[B])])])),_:1})])),_:1},8,["model","rules"])):h("",!0)])}));U.render=q,U.__scopeId="data-v-534d1ad4";var H=i({name:"Index",components:{Login:z,ForgetPassword:U},setup(){const e=n(!1);return{showReset:e,handleResetPwd:()=>{e.value=!0},handleToLogin:()=>{e.value=!1},vueLogo:M,viteLogo:"./assets/logo-vite.63a26457.svg"}}});const X=x();g("data-v-d29b2dfc");const K={class:"container"},$={class:"login-container"},ee={class:"login-left"},se=y("div",{class:"top"},[y("div",{class:"title"},[y("span",null,"欢迎使用")]),y("div",{class:"desc"},[y("span",null,"Vite2.x + ElementPlus + Vue3.x + TypeScript")])],-1),te={class:"bottom"},ae=y("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNTMuNzEgMzgiPjxkZWZzPjxzdHlsZT4uY2xzLTEsLmNscy0ye2ZpbGw6IzQwOWVmZjt9LmNscy0xe2ZpbGwtcnVsZTpldmVub2RkO308L3N0eWxlPjwvZGVmcz48dGl0bGU+6LWE5rqQIDE8L3RpdGxlPjxnIGlkPSLlm77lsYJfMiIgZGF0YS1uYW1lPSLlm77lsYIgMiI+PGcgaWQ9IuWbvuWxgl8xLTIiIGRhdGEtbmFtZT0i5Zu+5bGCIDEiPjxwYXRoIGlkPSJTaGFwZS1Db3B5IiBjbGFzcz0iY2xzLTEiIGQ9Ik0xNDIsMjYuMTZzLjI4LDAsLjgyLDBhLjcyLjcyLDAsMCwxLC42OS40MXMxLjA4LDIsMS4zNywyLjQ4LDAsLjQyLS4xMi40MWgwcy0uMzEsMC0zLjQ1LDBhNC45Myw0LjkzLDAsMCwxLTQuNTQtNC41NHYtN0gxMzQuM1YxNS4yOGMwLS4zNi40MS0uNDEuNDEtLjQxaDIuMDdWMTIuMjVhLjYuNiwwLDAsMSwuNDEtLjU1bDIuMy0uNjZjLjM0LS4xLjU5LDAsLjU5LjM1VjE1aDMuNThjLjM0LDAsLjQxLjQxLjQxLjQxVjE4aC00djYuMDZjMCwxLjc2LDEuOTMsMi4wNywxLjkzLDIuMDdabS0xMC42LDNoLTIuMmMtLjQzLDAtLjQxLS41NS0uNDEtLjU1VjE4LjQ1YzAtLjYyLS44My0uODMtLjgzLS44M2gtNC41NGMtLjY4LDAtLjY5LjgzLS42OS44M1YyOC43N2EuNDEuNDEsMCwwLDEtLjQxLjQyaC0yLjJjLS40OCwwLS40MS0uNTUtLjQxLS41NVYxNS44M2MwLTEsMS4yNC0xLjI0LDEuMjQtMS4yNGg5LjYzYzEsMCwxLjIzLDEuMjQsMS4yMywxLjI0VjI4LjVjMCwuNzItLjQxLjY5LS40MS42OVpNMTE1LjczLDIzLjRIMTA3LjJ2Mi4wN2MwLC43NCwxLDEsMSwxSDExNWExLjE2LDEuMTYsMCwwLDEsLjgyLjQycy42MSwxLjI1LjgzLDEuNzktLjQxLjU1LS40MS41NUgxMDZjLTEuMjQsMC0xLjUxLTEuNTItMS41MS0xLjUyVjE2YzAtLjY3LDEtMSwxLTFoMTAuMzJjMSwwLDEuMjQsMS4yMywxLjI0LDEuMjN2NS45M2MwLDEtMS4yNCwxLjIzLTEuMjQsMS4yM1ptLTEuNTItNC45NXMtLjA4LS42OS0uNjgtLjY5aC01LjY1cy0uNjguMTgtLjY4LjY5VjIwYS42OS42OSwwLDAsMCwuNjguNjloNS42NWEuOS45LDAsMCwwLC42OC0uODNWMTguNDVaTTEwMS4yOCwyOS4xOWgtMi4yYy0uMjksMC0uNDEtLjQyLS40MS0uNDJWMTguNDVjMC0uNjQtLjgzLS44My0uODMtLjgzSDk1Ljc4Yy0uNTgsMC0uNjkuODMtLjY5LjgzVjI4Ljc3YzAsLjM1LS40MS40Mi0uNDEuNDJoLTIuMmMtLjMxLDAtLjQyLS40Mi0uNDItLjQyVjE4LjQ1YzAtLjY2LS44Mi0uODMtLjgyLS44M0g4OS4xN2MtLjYzLDAtLjY4LjgzLS42OC44M1YyOC43N2EuMzkuMzksMCwwLDEtLjQyLjQyaC0yLjJhLjQxLjQxLDAsMCwxLS40MS0uNDJWMTUuNjljMC0uNzUsMS4xLTEuMSwxLjEtMS4xaDEzLjc2YzEuMSwwLDEuMzcsMS4zOCwxLjM3LDEuMzh2MTIuOGMwLC40OC0uNDEuNDItLjQxLjQyWm0tMjAtNS43OUg3Mi44djIuMDdjMCwuNzQsMSwxLDEsMWg2Ljg4YTEuMTksMS4xOSwwLDAsMSwuODMuNDJzLjYsMS4yNS44MiwxLjc5LS40MS41NS0uNDEuNTVINzEuNTZjLTEuMjQsMC0xLjUxLTEuNTItMS41MS0xLjUyVjE2YzAtLjY3LDEtMSwxLTFIODEuMzNjMSwwLDEuMjQsMS4yMywxLjI0LDEuMjN2NS45M2MwLDEtMS4yNCwxLjIzLTEuMjQsMS4yM1ptLTEuNTEtNC45NXMtLjA5LS42OS0uNjktLjY5SDczLjQ5cy0uNjkuMTgtLjY5LjY5VjIwYS42OS42OSwwLDAsMCwuNjkuNjloNS42NGEuOTEuOTEsMCwwLDAsLjY5LS44M1YxOC40NVpNNjgsMjkuMTlINjIuNzZhNC4zNSw0LjM1LDAsMCwxLTQuMTMtNGMwLTMuOTEsMC0xNi4xLDAtMTYuMWgyLjQ4YS43OS43OSwwLDAsMSwuODIuODJWMjQuMzdBMi41OCwyLjU4LDAsMCwwLDYzLjg2LDI2aDIuMnMuNzItLjIzLDEuMjQuNjlsMS4xLDEuOTNzLjA4LjU1LS40MS41NVptLTI2LjU2LS44M1YxMC4xOWExLDEsMCwwLDEsLjY5LTFINTUuMDVjLjczLDAsLjQyLjgzLjQyLjgzcy0uNDEsMS4xMi0uNjksMS42NWExLDEsMCwwLDEtLjgzLjU1SDQ1LjU2YS43Ny43NywwLDAsMC0uODMuNjl2NC41NGg5LjVjLjU1LDAsLjI3LjY5LjI3LjY5cy0uNzEsMS41Mi0xLDEuOTNhMS4wNSwxLjA1LDAsMCwxLS44My40MWgtOHY0LjgyYS45MS45MSwwLDAsMCwuNjkuODNoOC44MWEuODUuODUsMCwwLDEsLjgyLjQxbDEuMjQsMS45M2MuMzcuNTYtLjE0LjY5LS4xNC42OUg0Mi4yNkM0MS42OCwyOS4xOSw0MS40MywyOC4zNiw0MS40MywyOC4zNlptLTguMTQtMS4xNGMwLDEuNTctLjgzLDEuOTMtLjgzLDEuOTNTMTguMzIsMzcuMzEsMTcuNCwzNy44M2ExLjY4LDEuNjgsMCwwLDEtMS41MiwwUzEuMDksMjkuMjUuNTUsMjguODdhMS4yOSwxLjI5LDAsMCwxLS41NS0xczAtMTcsMC0xNy43OFMxLDguNzYsMSw4Ljc2TDE1Ljc1LjIxYTIsMiwwLDAsMSwxLjc5LDBTMzAuNiw3LjgsMzIsOC42MmEyLjA4LDIuMDgsMCwwLDEsMS4yNSwyLjA2czAsMTUuMDcsMCwxNi41NFptLTUuOS0xN2MtMy0xLjc0LTEwLjE2LTUuODctMTAuMTYtNS44N2ExLjU4LDEuNTgsMCwwLDAtMS40MSwwTDQuMjIsMTFzLS43Ny40Ni0uNzYsMS4wOFMzLjQ2LDI2LDMuNDYsMjZhMSwxLDAsMCwwLC40My43NWMuNDMuMywxMiw3LDEyLDdhMS4zLDEuMywwLDAsMCwxLjE5LDBjLjcyLS40LDExLjgyLTYuNzksMTEuODItNi43OXMuNjUtLjI4LjY1LTEuNTFjMC0uMzYsMC0xLjc0LDAtMy40N0wxNi41MywyOS44OHYtM2EzLDMsMCwwLDEsMS0yLjA3bDExLjU2LTdhMi40OSwyLjQ5LDAsMCwwLC41NS0xLjQ2YzAtMS4yNywwLTIuMzcsMC0zLjA3TDE2LjUzLDIxLjJWMThhMi4xNywyLjE3LDAsMCwxLC44My0xLjc5WiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTE1MC4zMiwxMS4yMWgtMi4yNHYtNWMwLS4xMS4xMi0uMjEuMjktLjI0bDEuNDQtLjI2Yy4yNiwwLC41MS4wNy41MS4yNFoiLz48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik0xNDguMDgsOWgyLjI0djUuMTFjMCwuMTEtLjExLjIxLS4yOC4yNWwtMS40NS4yNmMtLjI2LjA1LS41MS0uMDctLjUxLS4yNFoiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0xNDUuMDksOWg4LjIyYS40LjQsMCwwLDEsLjQuNHYxLjg1YTAsMCwwLDAsMSwwLDBoLTlhMCwwLDAsMCwxLDAsMFY5LjM2QS40LjQsMCwwLDEsMTQ1LjA5LDlaIi8+PC9nPjwvZz48L3N2Zz4="},null,-1),oe={class:"login-right"};p();const re=X(((e,s,t,a,o,r)=>{const l=N("Login"),L=N("ForgetPassword");return S(),D("div",K,[y("div",$,[y("div",ee,[se,y("div",te,[ae,y("div",null,[y("img",{class:"viteLogo",src:e.viteLogo},null,8,["src"]),y("img",{class:"vueLogo",src:e.vueLogo},null,8,["src"])])])]),y("div",oe,[e.showReset?(S(),D(L,{key:1,"show-reset":e.showReset,onToLogin:e.handleToLogin},null,8,["show-reset","onToLogin"])):(S(),D(l,{key:0,onToResetPwd:e.handleResetPwd},null,8,["onToResetPwd"]))])])])}));H.render=re,H.__scopeId="data-v-d29b2dfc";export default H;
